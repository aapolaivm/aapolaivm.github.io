import{K as get_store_value,S as SvelteComponent,i as init$1,s as safe_not_equal,e as empty$1,b as insert_hydration,H as noop$1,h as detach,L as svg_element,q as text,M as claim_svg_element,m as children$1,r as claim_text,n as attr,D as append_hydration,u as set_data,a as space,c as claim_space,g as transition_in,v as group_outros,d as transition_out,f as check_outros,N as listen,O as run_all,y as create_component,z as claim_component,A as mount_component,B as destroy_component,P as null_to_empty,I as component_subscribe,k as element,l as claim_element,p as set_style,Q as prevent_default,R as bubble,T as set_store_value,U as set_input_value,C as create_slot,E as update_slot_base,F as get_all_dirty_from_scope,G as get_slot_changes,j as afterUpdate,V as src_url_equal,J as destroy_each,W as createEventDispatcher,w as binding_callbacks,o as onMount,x as construct_svelte_component,X as HtmlTagHydration,Y as claim_html_tag}from"../chunks/index.21fe5810.js";import{w as writable}from"../chunks/index.cbaec432.js";const stores={},rightCb=(e,t,n,o)=>{const r=e+n,i=t+o/2;return[r,i,0]},leftCb=(e,t,n,o)=>{const r=e,i=t+o/2;return[r,i,180]},topCb=(e,t,n,o)=>[e+n/2,t,90],bottomCb=(e,t,n,o)=>{const r=e+n/2,i=t+o;return[r,i,270]};function getPotentialAnchorById(e,t){const o=get_store_value(e.potentialAnchorsStore)[t];if(o===void 0)throw"potential anchor not found";return o}function getPotentialAnchors(e,t){let n=Object.values(get_store_value(e.potentialAnchorsStore));return t!==void 0&&(n=n.filter(o=>{for(let r in t){const i=t[r];if(o[r]!==i)return!1}return!0})),n}function getNodeById(e,t){return get_store_value(e.nodesStore)[t]}function getAnchors(e,t){let n=Object.values(get_store_value(e.anchorsStore));return t!==void 0&&(n=n.filter(o=>{for(let r in t){const i=t[r];if(o[r]!==i)return!1}return!0})),n}function getAnchorFromEdge(e,t,n){getEdgeById(e,t);const o=getAnchors(e,{edgeId:t});if(o.length!==2)throw`there should be two anchors for a given edge, there are ${o.length}`;const r=o.filter(i=>i.sourceOrTarget===n);if(r.length!==1)throw"there should only be one source/target anchor";return r[0]}function getEdgeById(e,t){const o=get_store_value(e.edgesStore)[t];if(o===void 0)throw"edge not found";return o}function getAnchorById(e,t){return get_store_value(e.anchorsStore)[t]}function fixedCbCreator(e,t,n,o,r){const i=s;return i.type="fixed",i;function s(){const a=getAnchors(e,{edgeId:t});if(a.length!==2)throw`there should be two anchors per edge, have: ${a.length}`;let[l,c]=a;l.id!==n&&([l,c]=[c,l]);const u=getNodeById(e,o),{positionX:_,positionY:f,width:h,height:d}=u,[m,N,S]=r(_,f,h,d);l.positionX=m,l.positionY=N,l.angle=S,c.callback.type==="dynamic"&&c.callback()}}function dynamicCbCreator(e,t,n){const o=r;return o.type="dynamic",o;function r(){const i=getAnchors(e,{edgeId:t});if(i.length!==2)throw`there should be two anchors per edge, have: ${i.length}`;let[s,a]=i;s.id!==n&&([s,a]=[a,s]);const l=getNodeById(e,s.nodeId),c=getNodeById(e,a.nodeId),[u,_,f,h]=[l.positionX+l.width/2,l.positionY+l.height/2,c.positionX+c.width/2,c.positionY+c.height/2];let d=s.angle;const m=(_-h)/(u-f);if(Math.abs(m)<1)if(l.positionX<c.positionX){const[N,S]=rightCb(l.positionX,l.positionY,l.width,l.height);leftCb(c.positionX,c.positionY,c.width,c.height),s.setPosition(N,S),s.angle=0}else{const[N,S]=leftCb(l.positionX,l.positionY,l.width,l.height);rightCb(c.positionX,c.positionY,c.width,c.height),s.setPosition(N,S),s.angle=180}else if(l.positionY<c.positionY){const[N,S]=bottomCb(l.positionX,l.positionY,l.width,l.height);topCb(c.positionX,c.positionY,c.width,c.height),s.setPosition(N,S),s.angle=270}else{const[N,S]=topCb(l.positionX,l.positionY,l.width,l.height);bottomCb(c.positionX,c.positionY,c.width,c.height),s.setPosition(N,S),s.angle=90}d!==s.angle&&a.callback()}}function potentialAnchorCbCreator(e,t,n,o){return r;function r(){const i=getPotentialAnchorById(e,t),s=getNodeById(e,n),{positionX:a,positionY:l,width:c,height:u}=s,[_,f,h]=o(a,l,c,u);i.positionX=_,i.positionY=f,i.angle=h}}let ResizeNode$1=class{constructor(t,n,o,r,i){this.id=t,this.canvasId=n,this.nodeId=o,this.positionX=r,this.positionY=i}setPosition(t,n){this.positionX+=t,this.positionY+=n}setPositionAndCascade(t,n){const o=this.nodeId,{nodesStore:r}=stores[this.canvasId];r.update(i=>{const s=i[o];return s.width+t>20&&s.height+n>20&&(this.positionX+=t,this.positionY+=n,s.setSizeFromMovement(t,n)),{...i}})}delete(){stores[this.canvasId];const{resizeNodesStore:t}=stores[this.canvasId];t.update(n=>{for(const o in n)n[o].id===this.id&&delete n[o];return{...n}})}};class Anchor{constructor(t,n,o,r,i,s,a,l,c){this.id=t,this.nodeId=n,this.edgeId=o,this.sourceOrTarget=r,this.positionX=i,this.positionY=s,this.callback=a,this.canvasId=l,this.angle=c}getOtherAnchorId(){const t=stores[this.canvasId],n=getAnchors(t,{edgeId:this.edgeId});if(n.length!==2)throw"something is wrong, every anchor should have exactly one other associated anchor";return n.filter(r=>r.id!==this.id)[0].id}setPositionFromNode(){this.callback();const{edgesStore:t}=stores[this.canvasId];t.update(n=>{const o=n[this.edgeId];return this.sourceOrTarget==="source"?(o.sourceX=this.positionX,o.sourceY=this.positionY):(o.targetX=this.positionX,o.targetY=this.positionY),{...n}})}updateEdges(){const{edgesStore:t}=stores[this.canvasId];t.update(n=>{const o=n[this.edgeId];return o===void 0?{...n}:(this.sourceOrTarget==="source"?(o.sourceX=this.positionX,o.sourceY=this.positionY):(o.targetX=this.positionX,o.targetY=this.positionY),{...n})})}setPosition(t,n){this.positionX=t,this.positionY=n,this.updateEdges()}setPositionFromMovement(t,n){this.positionX+=t,this.positionY+=n;const{edgesStore:o}=stores[this.canvasId];o.update(r=>{const i=r[this.edgeId];return this.sourceOrTarget==="source"?(i.sourceX+=t,i.sourceY+=n):(i.targetX+=t,i.targetY+=n),{...r}})}}function getResizeNodes(e,t){let n=Object.values(get_store_value(e.resizeNodesStore));return t!==void 0&&(n=n.filter(o=>{for(let r in t){const i=t[r];if(o[r]!==i)return!1}return!0})),n}let Node$1=class{constructor(t,n,o,r,i,s,a,l,c,u,_,f,h,d,m,N){this.id=t,this.positionX=n,this.positionY=o,this.width=r,this.height=i,this.bgColor=s,this.data=a,this.canvasId=l,this.borderColor=c,this.image=u,this.src=_,this.textColor=f,this.borderRadius=h,this.childNodes=d,this.className=m,this.clickCallback=N}setPositionFromMovement(t,n){const{nodesStore:o,anchorsStore:r,resizeNodesStore:i,potentialAnchorsStore:s,boundary:a,lockedOption:l}=stores[this.canvasId];if(get_store_value(l))return;const c=get_store_value(a);typeof c=="object"&&(this.positionX+this.width+t>=c.x||this.positionY+this.height+n>=c.y||this.positionY+n<=0||this.positionX+t<=0)||(this.positionX+=t,this.positionY+=n,o.update(u=>{if(this.childNodes)for(const _ of this.childNodes)u[_].setPositionFromMovement(t,n);return{...u}}),r.update(u=>{for(const _ in u)u[_].nodeId===this.id&&u[_].setPositionFromNode();return{...u}}),s.update(u=>{for(const _ in u)u[_].nodeId===this.id&&u[_].callback();return{...u}}),i.update(u=>{for(const _ in u)u[_].nodeId===this.id&&u[_].setPosition(t,n);return{...u}}))}setSizeFromMovement(t,n){this.width+=t,this.height+=n;const{anchorsStore:o,potentialAnchorsStore:r}=stores[this.canvasId];o.update(i=>{for(const s in i)i[s].nodeId===this.id&&i[s].setPositionFromNode();return{...i}}),r.update(i=>{for(const s in i)i[s].nodeId===this.id&&i[s].callback();return{...i}})}delete(){const t=stores[this.canvasId],{nodesStore:n,anchorsStore:o,edgesStore:r}=stores[this.canvasId];n.update(l=>{for(const c in l)l[c].id===this.id&&delete l[c];return{...l}});const i=getAnchors(t,{nodeId:this.id});for(let l of i){const c=l.edgeId;getEdgeById(t,c).delete()}const s=getResizeNodes(t,{nodeId:this.id});for(const l of s)l.delete();const a=getPotentialAnchors(t,{nodeId:this.id});for(const l of a)l.delete()}setExportableData(){return{id:this.id,width:this.width,height:this.height,position:{x:this.positionX,y:this.positionY},data:this.data,bgColor:this.bgColor,borderColor:this.borderColor,textColor:this.textColor,borderRadius:this.borderRadius,image:this.image,src:this.src,childNodes:this.childNodes,customClassName:this.className}}};class Edge{constructor(t,n,o,r,i,s,a,l,c,u,_,f,h,d,m,N){this.id=t,this.sourceX=n,this.sourceY=o,this.targetX=r,this.targetY=i,this.canvasId=s,this.label=a,this.type=l,this.labelBgColor=c,this.labelTextColor=u,this.edgeColor=_,this.animate=f,this.noHandle=h,this.arrow=d,this.clickCallback=m,this.className=N}delete(){const t=stores[this.canvasId],{nodesStore:n,anchorsStore:o,edgesStore:r}=t,i=getAnchorFromEdge(t,this.id,"source"),s=getAnchorFromEdge(t,this.id,"target");o.update(a=>{for(const l in a)(l===i.id||l==s.id)&&delete a[l];return{...a}}),r.update(a=>(delete a[this.id],{...a}))}setExportableData(){const t={id:this.id,label:this.label,type:this.type,labelBgColor:this.labelBgColor,labelTextColor:this.labelTextColor,edgeColor:this.edgeColor,animate:this.animate,noHandle:this.noHandle,arrow:this.arrow,source:"dummy",target:"dummy"},n=findStore(this.canvasId),o=getAnchors(n,{edgeId:this.id});if(o.length!==2)throw"there should be two anchors per edge";for(const r of o)r.sourceOrTarget==="target"&&(t.target=r.nodeId),r.sourceOrTarget==="source"&&(t.source=r.nodeId);return t}}let PotentialAnchor$1=class{constructor(t,n,o,r,i,s,a){this.id=t,this.nodeId=n,this.callback=o,this.positionX=r,this.positionY=i,this.angle=s,this.canvasId=a}delete(){const{potentialAnchorsStore:t}=stores[this.canvasId];t.update(n=>{for(const o in n)n[o].id===this.id&&delete n[o];return{...n}})}};const pkStringGenerator$3=()=>(Math.random()+1).toString(36).substring(7);function createResizeNode(e,t,n,o){const r=pkStringGenerator$3();return new ResizeNode$1(r,e,t,n,o)}function createAnchor(e,t,n,o,r){if(t===null)throw"you cannot create an anchor without a user node (for now)";const i=r.id,s=pkStringGenerator$3();let a;n==="target"?a=r.targetAnchorCb:a=r.sourceAnchorCb;let l;return a===void 0?l=dynamicCbCreator(e,i,s):l=fixedCbCreator(e,i,s,t.id,a),new Anchor(s,t.id,i,n,-1,-1,l,o,0)}function populateEdgesStore(e,t,n){const o={};for(let r=0;r<t.length;r++){const i=t[r],{source:s,target:a,id:l,type:c,label:u,labelBgColor:_,labelTextColor:f,edgeColor:h,animate:d,noHandle:m,arrow:N,clickCallback:S,className:B}=i,M=getAnchors(e,{edgeId:l});if(M.length!==2)throw"We should have two anchors for every node";if(new Set(M.map(y=>y.sourceOrTarget)).size!==2)throw"we should have one source and one target anchor";let b,g;M[0].sourceOrTarget==="source"?(b=M[0],g=M[1]):(b=M[1],g=M[0]),o[l]=new Edge(l,b.positionX,b.positionY,g.positionX,g.positionY,n,i.label===void 0?"":i.label,i.type===void 0?"bezier":i.type,i.labelBgColor===void 0?"white":i.labelBgColor,i.labelTextColor===void 0?"black":i.labelTextColor,i.edgeColor===void 0?"black":i.edgeColor,i.animate===void 0?!1:i.animate,i.noHandle===void 0?!1:i.noHandle,i.arrow===void 0?!1:i.arrow,i.clickCallback===void 0?()=>{}:i.clickCallback,i.className===void 0?"":i.className)}e.edgesStore.set(o)}function findUserNodeById(e,t){for(let n=0;n<t.length;n++){const o=t[n];if(o.id===e)return o}return null}function createPotentialAnchor(e,t,n,o){const r=pkStringGenerator$3(),i=potentialAnchorCbCreator(t,r,n,e);return new PotentialAnchor$1(r,n,i,-1,-1,0,o)}function populatePotentialAnchorStore(e,t,n){const o={};for(let i=0;i<t.length;i++){const s=t[i];for(let a of[topCb,bottomCb,rightCb,leftCb]){const l=createPotentialAnchor(a,e,s.id,n);o[l.id]=l}}e.potentialAnchorsStore.set(o);const r=Object.values(get_store_value(e.potentialAnchorsStore));for(const i of r)i.callback()}function populateAnchorsStore(e,t,n,o){const r={};for(let s=0;s<n.length;s++){const a=n[s],{source:l,target:c}=a,u=findUserNodeById(l,t),_=findUserNodeById(c,t),f=createAnchor(e,u,"source",o,a),h=createAnchor(e,_,"target",o,a);r[f.id]=f,r[h.id]=h}e.anchorsStore.set(r);const i=getAnchors(e);for(const s of i)s.callback()}function populateNodesStore(e,t,n){const o={};for(let r=0;r<t.length;r++){const i=t[r],s=i.id,a=new Node$1(s.toString(),i.position.x,i.position.y,i.width,i.height,i.bgColor,i.data,n,i.borderColor===void 0?"black":i.borderColor,i.image===void 0?!1:i.image,i.src===void 0?"":i.src,i.textColor===void 0?"":i.textColor,i.borderRadius===void 0?0:i.borderRadius,i.childNodes===void 0?[]:i.childNodes,i.className===void 0?"":i.className,i.clickCallback===void 0?()=>{}:i.clickCallback);o[s]=a}e.nodesStore.set(o)}function populateResizeNodeStore(e,t,n){const o={};for(let r=0;r<t.length;r++){const i=t[r],{id:s,width:a,height:l,position:c}=i,u=createResizeNode(n,s,c.x+a,c.y+l);o[u.id]=u}e.resizeNodesStore.set(o)}class Collapsible{constructor(t,n,o,r){this.id=t,this.nodeId=n,this.hideCount=o,this.state=r}isHidden(){return this.hideCount>0}toggleState(){this.state=this.state==="expanded"?"collapsed":"expanded"}}const pkStringGenerator$2=()=>(Math.random()+1).toString(36).substring(7);function populateCollapsibleStore(e,t,n,o){const r=[];for(let i of t){const s=new Collapsible(pkStringGenerator$2(),i.id,0,"expanded");r.push(s)}e.collapsibleStore.set(r)}function findTargets(e,t){const n=getAnchors(e,{nodeId:t,sourceOrTarget:"source"}),o=[];for(const r of n){const i=r.getOtherAnchorId(),s=getAnchorById(e,i);o.push(s.nodeId)}return o}function traverseAndIncrement(e,t,n){const o=get_store_value(e.collapsibleStore);r(t),e.collapsibleStore.set(o);function r(i){for(const s of o)if(s.nodeId===i){n==="increment"?s.hideCount++:s.hideCount--;const a=findTargets(e,i);for(const l of a)r(l)}}}function collapse(e,t){const n=findTargets(e,t);for(const o of n)traverseAndIncrement(e,o,"increment")}function expand(e,t){const n=findTargets(e,t);for(const o of n)traverseAndIncrement(e,o,"decrement")}function toggleExpandAndCollapse(e,t){const n=getCollapsibles(e,{nodeId:t});if(n.length===0)return;if(n.length>1)throw"there should only be one collapsible object per node";const o=n[0];o.state==="expanded"?collapse(e,t):expand(e,t),e.collapsibleStore.update(r=>{for(const i of r)i.id===o.id&&i.toggleState();return[...r]})}function getCollapsibles(e,t){let n=Object.values(get_store_value(e.collapsibleStore));return t!==void 0&&(n=n.filter(o=>{for(let r in t){const i=t[r];if(o[r]!==i)return!1}return!0})),n}function filterByCollapsible(e,t,n,o,r){const i=t.filter(_=>{const f=_.id,h=get_store_value(e.collapsibleStore).find(d=>d.nodeId===f);return h===void 0?!0:h.isHidden()===!1}),s=i.map(_=>_.id),a=n.filter(_=>s.includes(_.nodeId)),l=o.filter(_=>{const f=_.getOtherAnchorId(),h=get_store_value(e.anchorsStore)[f];return!!(s.includes(_.nodeId)&&s.includes(h.nodeId))}),c=new Set(l.map(_=>_.edgeId)),u=r.filter(_=>c.has(_.id));return{filteredNodes:i,filteredResizeNodes:a,filteredAnchors:l,filteredEdges:u}}function findStore(e){return stores[e]}function createStoreEmpty(e){return stores[e]={nodesStore:writable({}),edgesStore:writable({}),anchorsStore:writable({}),resizeNodesStore:writable({}),potentialAnchorsStore:writable({}),widthStore:writable(600),heightStore:writable(600),backgroundStore:writable(!1),movementStore:writable(!0),nodeSelected:writable(!1),nodeIdSelected:writable(-1),d3Scale:writable(1),options:writable({}),temporaryEdgeStore:writable([]),nodeCreate:writable(!1),boundary:writable(!1),edgeEditModal:writable(null),collapsibleStore:writable([]),collapsibleOption:writable(!1),lockedOption:writable(!1),editableOption:writable(!1),d3ZoomParameters:writable({}),resizableOption:writable(!0),highlightEdgesOption:writable(!0)},stores[e]}function populateSvelvetStoreFromUserInput(e,t,n){const o=findStore(e);populateNodesStore(o,t,e),populateAnchorsStore(o,t,n,e),populateEdgesStore(o,n,e),get_store_value(o.resizableOption)&&populateResizeNodeStore(o,t,e),get_store_value(o.nodeCreate)&&populatePotentialAnchorStore(o,t,e),get_store_value(o.collapsibleOption)&&populateCollapsibleStore(o,t)}var noop={value:()=>{}};function dispatch(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new Dispatch(n)}function Dispatch(e){this._=e}function parseTypenames$1(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(e,t){var n=this._,o=parseTypenames$1(e+"",n),r,i=-1,s=o.length;if(arguments.length<2){for(;++i<s;)if((r=(e=o[i]).type)&&(r=get$1(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(r=(e=o[i]).type)n[r]=set$1(n[r],e.name,t);else if(t==null)for(r in n)n[r]=set$1(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Dispatch(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,i;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],o=0,r=i.length;o<r;++o)i[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)}};function get$1(e,t){for(var n=0,o=e.length,r;n<o;++n)if((r=e[n]).name===t)return r.value}function set$1(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=noop,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var xhtml="http://www.w3.org/1999/xhtml";const namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),namespaces.hasOwnProperty(t)?{space:namespaces[t],local:e}:e}function creatorInherit(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===xhtml&&t.documentElement.namespaceURI===xhtml?t.createElement(e):t.createElementNS(n,e)}}function creatorFixed(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function creator(e){var t=namespace(e);return(t.local?creatorFixed:creatorInherit)(t)}function none(){}function selector(e){return e==null?none:function(){return this.querySelector(e)}}function selection_select(e){typeof e!="function"&&(e=selector(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=new Array(s),l,c,u=0;u<s;++u)(l=i[u])&&(c=e.call(l,l.__data__,u,i))&&("__data__"in l&&(c.__data__=l.__data__),a[u]=c);return new Selection$1(o,this._parents)}function array(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function empty(){return[]}function selectorAll(e){return e==null?empty:function(){return this.querySelectorAll(e)}}function arrayAll(e){return function(){return array(e.apply(this,arguments))}}function selection_selectAll(e){typeof e=="function"?e=arrayAll(e):e=selectorAll(e);for(var t=this._groups,n=t.length,o=[],r=[],i=0;i<n;++i)for(var s=t[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&(o.push(e.call(l,l.__data__,c,s)),r.push(l));return new Selection$1(o,r)}function matcher(e){return function(){return this.matches(e)}}function childMatcher(e){return function(t){return t.matches(e)}}var find=Array.prototype.find;function childFind(e){return function(){return find.call(this.children,e)}}function childFirst(){return this.firstElementChild}function selection_selectChild(e){return this.select(e==null?childFirst:childFind(typeof e=="function"?e:childMatcher(e)))}var filter=Array.prototype.filter;function children(){return Array.from(this.children)}function childrenFilter(e){return function(){return filter.call(this.children,e)}}function selection_selectChildren(e){return this.selectAll(e==null?children:childrenFilter(typeof e=="function"?e:childMatcher(e)))}function selection_filter(e){typeof e!="function"&&(e=matcher(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=[],l,c=0;c<s;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&a.push(l);return new Selection$1(o,this._parents)}function sparse(e){return new Array(e.length)}function selection_enter(){return new Selection$1(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}EnterNode.prototype={constructor:EnterNode,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function constant$2(e){return function(){return e}}function bindIndex(e,t,n,o,r,i){for(var s=0,a,l=t.length,c=i.length;s<c;++s)(a=t[s])?(a.__data__=i[s],o[s]=a):n[s]=new EnterNode(e,i[s]);for(;s<l;++s)(a=t[s])&&(r[s]=a)}function bindKey(e,t,n,o,r,i,s){var a,l,c=new Map,u=t.length,_=i.length,f=new Array(u),h;for(a=0;a<u;++a)(l=t[a])&&(f[a]=h=s.call(l,l.__data__,a,t)+"",c.has(h)?r[a]=l:c.set(h,l));for(a=0;a<_;++a)h=s.call(e,i[a],a,i)+"",(l=c.get(h))?(o[a]=l,l.__data__=i[a],c.delete(h)):n[a]=new EnterNode(e,i[a]);for(a=0;a<u;++a)(l=t[a])&&c.get(f[a])===l&&(r[a]=l)}function datum(e){return e.__data__}function selection_data(e,t){if(!arguments.length)return Array.from(this,datum);var n=t?bindKey:bindIndex,o=this._parents,r=this._groups;typeof e!="function"&&(e=constant$2(e));for(var i=r.length,s=new Array(i),a=new Array(i),l=new Array(i),c=0;c<i;++c){var u=o[c],_=r[c],f=_.length,h=arraylike(e.call(u,u&&u.__data__,c,o)),d=h.length,m=a[c]=new Array(d),N=s[c]=new Array(d),S=l[c]=new Array(f);n(u,_,m,N,S,h,t);for(var B=0,M=0,b,g;B<d;++B)if(b=m[B]){for(B>=M&&(M=B+1);!(g=N[M])&&++M<d;);b._next=g||null}}return s=new Selection$1(s,o),s._enter=a,s._exit=l,s}function arraylike(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function selection_exit(){return new Selection$1(this._exit||this._groups.map(sparse),this._parents)}function selection_join(e,t,n){var o=this.enter(),r=this,i=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?i.remove():n(i),o&&r?o.merge(r).order():r}function selection_merge(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,r=n.length,i=o.length,s=Math.min(r,i),a=new Array(r),l=0;l<s;++l)for(var c=n[l],u=o[l],_=c.length,f=a[l]=new Array(_),h,d=0;d<_;++d)(h=c[d]||u[d])&&(f[d]=h);for(;l<r;++l)a[l]=n[l];return new Selection$1(a,this._parents)}function selection_order(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],r=o.length-1,i=o[r],s;--r>=0;)(s=o[r])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function selection_sort(e){e||(e=ascending);function t(_,f){return _&&f?e(_.__data__,f.__data__):!_-!f}for(var n=this._groups,o=n.length,r=new Array(o),i=0;i<o;++i){for(var s=n[i],a=s.length,l=r[i]=new Array(a),c,u=0;u<a;++u)(c=s[u])&&(l[u]=c);l.sort(t)}return new Selection$1(r,this._parents).order()}function ascending(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function selection_call(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function selection_nodes(){return Array.from(this)}function selection_node(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length;r<i;++r){var s=o[r];if(s)return s}return null}function selection_size(){let e=0;for(const t of this)++e;return e}function selection_empty(){return!this.node()}function selection_each(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var r=t[n],i=0,s=r.length,a;i<s;++i)(a=r[i])&&e.call(a,a.__data__,i,r);return this}function attrRemove$1(e){return function(){this.removeAttribute(e)}}function attrRemoveNS$1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant$1(e,t){return function(){this.setAttribute(e,t)}}function attrConstantNS$1(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function attrFunction$1(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function attrFunctionNS$1(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function selection_attr(e,t){var n=namespace(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?attrRemoveNS$1:attrRemove$1:typeof t=="function"?n.local?attrFunctionNS$1:attrFunction$1:n.local?attrConstantNS$1:attrConstant$1)(n,t))}function defaultView(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function styleRemove$1(e){return function(){this.style.removeProperty(e)}}function styleConstant$1(e,t,n){return function(){this.style.setProperty(e,t,n)}}function styleFunction$1(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function selection_style(e,t,n){return arguments.length>1?this.each((t==null?styleRemove$1:typeof t=="function"?styleFunction$1:styleConstant$1)(e,t,n??"")):styleValue(this.node(),e)}function styleValue(e,t){return e.style.getPropertyValue(t)||defaultView(e).getComputedStyle(e,null).getPropertyValue(t)}function propertyRemove(e){return function(){delete this[e]}}function propertyConstant(e,t){return function(){this[e]=t}}function propertyFunction(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function selection_property(e,t){return arguments.length>1?this.each((t==null?propertyRemove:typeof t=="function"?propertyFunction:propertyConstant)(e,t)):this.node()[e]}function classArray(e){return e.trim().split(/^|\s+/)}function classList(e){return e.classList||new ClassList(e)}function ClassList(e){this._node=e,this._names=classArray(e.getAttribute("class")||"")}ClassList.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function classedAdd(e,t){for(var n=classList(e),o=-1,r=t.length;++o<r;)n.add(t[o])}function classedRemove(e,t){for(var n=classList(e),o=-1,r=t.length;++o<r;)n.remove(t[o])}function classedTrue(e){return function(){classedAdd(this,e)}}function classedFalse(e){return function(){classedRemove(this,e)}}function classedFunction(e,t){return function(){(t.apply(this,arguments)?classedAdd:classedRemove)(this,e)}}function selection_classed(e,t){var n=classArray(e+"");if(arguments.length<2){for(var o=classList(this.node()),r=-1,i=n.length;++r<i;)if(!o.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?classedFunction:t?classedTrue:classedFalse)(n,t))}function textRemove(){this.textContent=""}function textConstant$1(e){return function(){this.textContent=e}}function textFunction$1(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function selection_text(e){return arguments.length?this.each(e==null?textRemove:(typeof e=="function"?textFunction$1:textConstant$1)(e)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(e){return function(){this.innerHTML=e}}function htmlFunction(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function selection_html(e){return arguments.length?this.each(e==null?htmlRemove:(typeof e=="function"?htmlFunction:htmlConstant)(e)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(e){var t=typeof e=="function"?e:creator(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function constantNull(){return null}function selection_insert(e,t){var n=typeof e=="function"?e:creator(e),o=t==null?constantNull:typeof t=="function"?t:selector(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function remove(){var e=this.parentNode;e&&e.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_cloneShallow(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function selection_cloneDeep(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function selection_clone(e){return this.select(e?selection_cloneDeep:selection_cloneShallow)}function selection_datum(e){return arguments.length?this.property("__data__",e):this.node().__data__}function contextListener(e){return function(t){e.call(this,t,this.__data__)}}function parseTypenames(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function onRemove(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,r=t.length,i;n<r;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++o]=i;++o?t.length=o:delete this.__on}}}function onAdd(e,t,n){return function(){var o=this.__on,r,i=contextListener(t);if(o){for(var s=0,a=o.length;s<a;++s)if((r=o[s]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),r.value=t;return}}this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(r):this.__on=[r]}}function selection_on(e,t,n){var o=parseTypenames(e+""),r,i=o.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,u;l<c;++l)for(r=0,u=a[l];r<i;++r)if((s=o[r]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?onAdd:onRemove,r=0;r<i;++r)this.each(a(o[r],t,n));return this}function dispatchEvent(e,t,n){var o=defaultView(e),r=o.CustomEvent;typeof r=="function"?r=new r(t,n):(r=o.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function dispatchConstant(e,t){return function(){return dispatchEvent(this,e,t)}}function dispatchFunction(e,t){return function(){return dispatchEvent(this,e,t.apply(this,arguments))}}function selection_dispatch(e,t){return this.each((typeof t=="function"?dispatchFunction:dispatchConstant)(e,t))}function*selection_iterator(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length,s;r<i;++r)(s=o[r])&&(yield s)}var root=[null];function Selection$1(e,t){this._groups=e,this._parents=t}function selection(){return new Selection$1([[document.documentElement]],root)}function selection_selection(){return this}Selection$1.prototype=selection.prototype={constructor:Selection$1,select:selection_select,selectAll:selection_selectAll,selectChild:selection_selectChild,selectChildren:selection_selectChildren,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,join:selection_join,merge:selection_merge,selection:selection_selection,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch,[Symbol.iterator]:selection_iterator};function select(e){return typeof e=="string"?new Selection$1([[document.querySelector(e)]],[document.documentElement]):new Selection$1([[e]],root)}function sourceEvent(e){let t;for(;t=e.sourceEvent;)e=t;return e}function pointer(e,t){if(e=sourceEvent(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}function selectAll(e){return typeof e=="string"?new Selection$1([document.querySelectorAll(e)],[document.documentElement]):new Selection$1([array(e)],root)}const nonpassivecapture={capture:!0,passive:!1};function noevent$1(e){e.preventDefault(),e.stopImmediatePropagation()}function dragDisable(e){var t=e.document.documentElement,n=select(e).on("dragstart.drag",noevent$1,nonpassivecapture);"onselectstart"in t?n.on("selectstart.drag",noevent$1,nonpassivecapture):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function yesdrag(e,t){var n=e.document.documentElement,o=select(e).on("dragstart.drag",null);t&&(o.on("click.drag",noevent$1,nonpassivecapture),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function define(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function extend(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=reHex.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?rgbn(t):n===3?new Rgb(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?rgba(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?rgba(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=reRgbInteger.exec(e))?new Rgb(t[1],t[2],t[3],1):(t=reRgbPercent.exec(e))?new Rgb(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=reRgbaInteger.exec(e))?rgba(t[1],t[2],t[3],t[4]):(t=reRgbaPercent.exec(e))?rgba(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=reHslPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,1):(t=reHslaPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,t[4]):named.hasOwnProperty(e)?rgbn(named[e]):e==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(e){return new Rgb(e>>16&255,e>>8&255,e&255,1)}function rgba(e,t,n,o){return o<=0&&(e=t=n=NaN),new Rgb(e,t,n,o)}function rgbConvert(e){return e instanceof Color||(e=color(e)),e?(e=e.rgb(),new Rgb(e.r,e.g,e.b,e.opacity)):new Rgb}function rgb(e,t,n,o){return arguments.length===1?rgbConvert(e):new Rgb(e,t,n,o??1)}function Rgb(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}define(Rgb,rgb,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const e=clampa(this.opacity);return`${e===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${e===1?")":`, ${e})`}`}function clampa(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function clampi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hex(e){return e=clampi(e),(e<16?"0":"")+e.toString(16)}function hsla(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Hsl(e,t,n,o)}function hslConvert(e){if(e instanceof Hsl)return new Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof Color||(e=color(e)),!e)return new Hsl;if(e instanceof Hsl)return e;e=e.rgb();var t=e.r/255,n=e.g/255,o=e.b/255,r=Math.min(t,n,o),i=Math.max(t,n,o),s=NaN,a=i-r,l=(i+r)/2;return a?(t===i?s=(n-o)/a+(n<o)*6:n===i?s=(o-t)/a+2:s=(t-n)/a+4,a/=l<.5?i+r:2-i-r,s*=60):a=l>0&&l<1?0:s,new Hsl(s,a,l,e.opacity)}function hsl(e,t,n,o){return arguments.length===1?hslConvert(e):new Hsl(e,t,n,o??1)}function Hsl(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}define(Hsl,hsl,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,r=2*n-o;return new Rgb(hsl2rgb(e>=240?e-240:e+120,r,o),hsl2rgb(e,r,o),hsl2rgb(e<120?e+240:e-120,r,o),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=clampa(this.opacity);return`${e===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function clamph(e){return e=(e||0)%360,e<0?e+360:e}function clampt(e){return Math.max(0,Math.min(1,e||0))}function hsl2rgb(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const constant$1=e=>()=>e;function linear(e,t){return function(n){return e+n*t}}function exponential(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}function gamma(e){return(e=+e)==1?nogamma:function(t,n){return n-t?exponential(t,n,e):constant$1(isNaN(t)?n:t)}}function nogamma(e,t){var n=t-e;return n?linear(e,n):constant$1(isNaN(e)?t:e)}const interpolateRgb=function e(t){var n=gamma(t);function o(r,i){var s=n((r=rgb(r)).r,(i=rgb(i)).r),a=n(r.g,i.g),l=n(r.b,i.b),c=nogamma(r.opacity,i.opacity);return function(u){return r.r=s(u),r.g=a(u),r.b=l(u),r.opacity=c(u),r+""}}return o.gamma=e,o}(1);function interpolateNumber(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(e){return function(){return e}}function one(e){return function(t){return e(t)+""}}function interpolateString(e,t){var n=reA.lastIndex=reB.lastIndex=0,o,r,i,s=-1,a=[],l=[];for(e=e+"",t=t+"";(o=reA.exec(e))&&(r=reB.exec(t));)(i=r.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(o=o[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:interpolateNumber(o,r)})),n=reB.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?one(l[0].x):zero(t):(t=l.length,function(c){for(var u=0,_;u<t;++u)a[(_=l[u]).i]=_.x(c);return a.join("")})}var degrees=180/Math.PI,identity$1={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(e,t,n,o,r,i){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*o)&&(n-=e*l,o-=t*l),(a=Math.sqrt(n*n+o*o))&&(n/=a,o/=a,l/=a),e*o<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*degrees,skewX:Math.atan(l)*degrees,scaleX:s,scaleY:a}}var svgNode;function parseCss(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?identity$1:decompose(t.a,t.b,t.c,t.d,t.e,t.f)}function parseSvg(e){return e==null||(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",e),!(e=svgNode.transform.baseVal.consolidate()))?identity$1:(e=e.matrix,decompose(e.a,e.b,e.c,e.d,e.e,e.f))}function interpolateTransform(e,t,n,o){function r(c){return c.length?c.pop()+" ":""}function i(c,u,_,f,h,d){if(c!==_||u!==f){var m=h.push("translate(",null,t,null,n);d.push({i:m-4,x:interpolateNumber(c,_)},{i:m-2,x:interpolateNumber(u,f)})}else(_||f)&&h.push("translate("+_+t+f+n)}function s(c,u,_,f){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),f.push({i:_.push(r(_)+"rotate(",null,o)-2,x:interpolateNumber(c,u)})):u&&_.push(r(_)+"rotate("+u+o)}function a(c,u,_,f){c!==u?f.push({i:_.push(r(_)+"skewX(",null,o)-2,x:interpolateNumber(c,u)}):u&&_.push(r(_)+"skewX("+u+o)}function l(c,u,_,f,h,d){if(c!==_||u!==f){var m=h.push(r(h)+"scale(",null,",",null,")");d.push({i:m-4,x:interpolateNumber(c,_)},{i:m-2,x:interpolateNumber(u,f)})}else(_!==1||f!==1)&&h.push(r(h)+"scale("+_+","+f+")")}return function(c,u){var _=[],f=[];return c=e(c),u=e(u),i(c.translateX,c.translateY,u.translateX,u.translateY,_,f),s(c.rotate,u.rotate,_,f),a(c.skewX,u.skewX,_,f),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,_,f),c=u=null,function(h){for(var d=-1,m=f.length,N;++d<m;)_[(N=f[d]).i]=N.x(h);return _.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),epsilon2=1e-12;function cosh(e){return((e=Math.exp(e))+1/e)/2}function sinh(e){return((e=Math.exp(e))-1/e)/2}function tanh(e){return((e=Math.exp(2*e))-1)/(e+1)}const interpolateZoom=function e(t,n,o){function r(i,s){var a=i[0],l=i[1],c=i[2],u=s[0],_=s[1],f=s[2],h=u-a,d=_-l,m=h*h+d*d,N,S;if(m<epsilon2)S=Math.log(f/c)/t,N=function(I){return[a+I*h,l+I*d,c*Math.exp(t*I*S)]};else{var B=Math.sqrt(m),M=(f*f-c*c+o*m)/(2*c*n*B),b=(f*f-c*c-o*m)/(2*f*n*B),g=Math.log(Math.sqrt(M*M+1)-M),y=Math.log(Math.sqrt(b*b+1)-b);S=(y-g)/t,N=function(I){var T=I*S,v=cosh(g),k=c/(n*B)*(v*tanh(t*T+g)-sinh(g));return[a+k*h,l+k*d,c*v/cosh(t*T+g)]}}return N.duration=S*1e3*t/Math.SQRT2,N}return r.rho=function(i){var s=Math.max(.001,+i),a=s*s,l=a*a;return e(s,a,l)},r}(Math.SQRT2,2,4);var frame=0,timeout$1=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}Timer.prototype=timer.prototype={constructor:Timer,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?now():+n)+(t==null?0:+t),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=e,this._time=n,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};function timer(e,t,n){var o=new Timer;return o.restart(e,t,n),o}function timerFlush(){now(),++frame;for(var e=taskHead,t;e;)(t=clockNow-e._time)>=0&&e._call.call(void 0,t),e=e._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout$1=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var e=clock.now(),t=e-clockLast;t>pokeDelay&&(clockSkew-=t,clockLast=e)}function nap(){for(var e,t=taskHead,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:taskHead=n);taskTail=e,sleep(o)}function sleep(e){if(!frame){timeout$1&&(timeout$1=clearTimeout(timeout$1));var t=e-clockNow;t>24?(e<1/0&&(timeout$1=setTimeout(wake,e-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function timeout(e,t,n){var o=new Timer;return t=t==null?0:+t,o.restart(r=>{o.stop(),e(r+t)},t,n),o}var emptyOn=dispatch("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(e,t,n,o,r,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;create(e,n,{name:t,index:o,group:r,on:emptyOn,tween:emptyTween,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:CREATED})}function init(e,t){var n=get(e,t);if(n.state>CREATED)throw new Error("too late; already scheduled");return n}function set(e,t){var n=get(e,t);if(n.state>STARTED)throw new Error("too late; already running");return n}function get(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function create(e,t,n){var o=e.__transition,r;o[t]=n,n.timer=timer(i,0,n.time);function i(c){n.state=SCHEDULED,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var u,_,f,h;if(n.state!==SCHEDULED)return l();for(u in o)if(h=o[u],h.name===n.name){if(h.state===STARTED)return timeout(s);h.state===RUNNING?(h.state=ENDED,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete o[u]):+u<t&&(h.state=ENDED,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete o[u])}if(timeout(function(){n.state===STARTED&&(n.state=RUNNING,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=STARTING,n.on.call("start",e,e.__data__,n.index,n.group),n.state===STARTING){for(n.state=STARTED,r=new Array(f=n.tween.length),u=0,_=-1;u<f;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(r[++_]=h);r.length=_+1}}function a(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=ENDING,1),_=-1,f=r.length;++_<f;)r[_].call(e,u);n.state===ENDING&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=ENDED,n.timer.stop(),delete o[t];for(var c in o)return;delete e.__transition}}function interrupt(e,t){var n=e.__transition,o,r,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((o=n[s]).name!==t){i=!1;continue}r=o.state>STARTING&&o.state<ENDING,o.state=ENDED,o.timer.stop(),o.on.call(r?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[s]}i&&delete e.__transition}}function selection_interrupt(e){return this.each(function(){interrupt(this,e)})}function tweenRemove(e,t){var n,o;return function(){var r=set(this,e),i=r.tween;if(i!==n){o=n=i;for(var s=0,a=o.length;s<a;++s)if(o[s].name===t){o=o.slice(),o.splice(s,1);break}}r.tween=o}}function tweenFunction(e,t,n){var o,r;if(typeof n!="function")throw new Error;return function(){var i=set(this,e),s=i.tween;if(s!==o){r=(o=s).slice();for(var a={name:t,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===t){r[l]=a;break}l===c&&r.push(a)}i.tween=r}}function transition_tween(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=get(this.node(),n).tween,r=0,i=o.length,s;r<i;++r)if((s=o[r]).name===e)return s.value;return null}return this.each((t==null?tweenRemove:tweenFunction)(n,e,t))}function tweenValue(e,t,n){var o=e._id;return e.each(function(){var r=set(this,o);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return get(r,o).value[t]}}function interpolate(e,t){var n;return(typeof t=="number"?interpolateNumber:t instanceof color?interpolateRgb:(n=color(t))?(t=n,interpolateRgb):interpolateString)(e,t)}function attrRemove(e){return function(){this.removeAttribute(e)}}function attrRemoveNS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttribute(e);return s===r?null:s===o?i:i=t(o=s,n)}}function attrConstantNS(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===r?null:s===o?i:i=t(o=s,n)}}function attrFunction(e,t,n){var o,r,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),l=a+"",s===l?null:s===o&&l===r?i:(r=l,i=t(o=s,a)))}}function attrFunctionNS(e,t,n){var o,r,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),l=a+"",s===l?null:s===o&&l===r?i:(r=l,i=t(o=s,a)))}}function transition_attr(e,t){var n=namespace(e),o=n==="transform"?interpolateTransformSvg:interpolate;return this.attrTween(e,typeof t=="function"?(n.local?attrFunctionNS:attrFunction)(n,o,tweenValue(this,"attr."+e,t)):t==null?(n.local?attrRemoveNS:attrRemove)(n):(n.local?attrConstantNS:attrConstant)(n,o,t))}function attrInterpolate(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function attrInterpolateNS(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function attrTweenNS(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&attrInterpolateNS(e,i)),n}return r._value=t,r}function attrTween(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&attrInterpolate(e,i)),n}return r._value=t,r}function transition_attrTween(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=namespace(e);return this.tween(n,(o.local?attrTweenNS:attrTween)(o,t))}function delayFunction(e,t){return function(){init(this,e).delay=+t.apply(this,arguments)}}function delayConstant(e,t){return t=+t,function(){init(this,e).delay=t}}function transition_delay(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?delayFunction:delayConstant)(t,e)):get(this.node(),t).delay}function durationFunction(e,t){return function(){set(this,e).duration=+t.apply(this,arguments)}}function durationConstant(e,t){return t=+t,function(){set(this,e).duration=t}}function transition_duration(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?durationFunction:durationConstant)(t,e)):get(this.node(),t).duration}function easeConstant(e,t){if(typeof t!="function")throw new Error;return function(){set(this,e).ease=t}}function transition_ease(e){var t=this._id;return arguments.length?this.each(easeConstant(t,e)):get(this.node(),t).ease}function easeVarying(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;set(this,e).ease=n}}function transition_easeVarying(e){if(typeof e!="function")throw new Error;return this.each(easeVarying(this._id,e))}function transition_filter(e){typeof e!="function"&&(e=matcher(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=[],l,c=0;c<s;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&a.push(l);return new Transition(o,this._parents,this._name,this._id)}function transition_merge(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,r=n.length,i=Math.min(o,r),s=new Array(o),a=0;a<i;++a)for(var l=t[a],c=n[a],u=l.length,_=s[a]=new Array(u),f,h=0;h<u;++h)(f=l[h]||c[h])&&(_[h]=f);for(;a<o;++a)s[a]=t[a];return new Transition(s,this._parents,this._name,this._id)}function start(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function onFunction(e,t,n){var o,r,i=start(t)?init:set;return function(){var s=i(this,e),a=s.on;a!==o&&(r=(o=a).copy()).on(t,n),s.on=r}}function transition_on(e,t){var n=this._id;return arguments.length<2?get(this.node(),n).on.on(e):this.each(onFunction(n,e,t))}function removeFunction(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function transition_remove(){return this.on("end.remove",removeFunction(this._id))}function transition_select(e){var t=this._name,n=this._id;typeof e!="function"&&(e=selector(e));for(var o=this._groups,r=o.length,i=new Array(r),s=0;s<r;++s)for(var a=o[s],l=a.length,c=i[s]=new Array(l),u,_,f=0;f<l;++f)(u=a[f])&&(_=e.call(u,u.__data__,f,a))&&("__data__"in u&&(_.__data__=u.__data__),c[f]=_,schedule(c[f],t,n,f,c,get(u,n)));return new Transition(i,this._parents,t,n)}function transition_selectAll(e){var t=this._name,n=this._id;typeof e!="function"&&(e=selectorAll(e));for(var o=this._groups,r=o.length,i=[],s=[],a=0;a<r;++a)for(var l=o[a],c=l.length,u,_=0;_<c;++_)if(u=l[_]){for(var f=e.call(u,u.__data__,_,l),h,d=get(u,n),m=0,N=f.length;m<N;++m)(h=f[m])&&schedule(h,t,n,m,f,d);i.push(f),s.push(u)}return new Transition(i,s,t,n)}var Selection=selection.prototype.constructor;function transition_selection(){return new Selection(this._groups,this._parents)}function styleNull(e,t){var n,o,r;return function(){var i=styleValue(this,e),s=(this.style.removeProperty(e),styleValue(this,e));return i===s?null:i===n&&s===o?r:r=t(n=i,o=s)}}function styleRemove(e){return function(){this.style.removeProperty(e)}}function styleConstant(e,t,n){var o,r=n+"",i;return function(){var s=styleValue(this,e);return s===r?null:s===o?i:i=t(o=s,n)}}function styleFunction(e,t,n){var o,r,i;return function(){var s=styleValue(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),styleValue(this,e))),s===l?null:s===o&&l===r?i:(r=l,i=t(o=s,a))}}function styleMaybeRemove(e,t){var n,o,r,i="style."+t,s="end."+i,a;return function(){var l=set(this,e),c=l.on,u=l.value[i]==null?a||(a=styleRemove(t)):void 0;(c!==n||r!==u)&&(o=(n=c).copy()).on(s,r=u),l.on=o}}function transition_style(e,t,n){var o=(e+="")=="transform"?interpolateTransformCss:interpolate;return t==null?this.styleTween(e,styleNull(e,o)).on("end.style."+e,styleRemove(e)):typeof t=="function"?this.styleTween(e,styleFunction(e,o,tweenValue(this,"style."+e,t))).each(styleMaybeRemove(this._id,e)):this.styleTween(e,styleConstant(e,o,t),n).on("end.style."+e,null)}function styleInterpolate(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function styleTween(e,t,n){var o,r;function i(){var s=t.apply(this,arguments);return s!==r&&(o=(r=s)&&styleInterpolate(e,s,n)),o}return i._value=t,i}function transition_styleTween(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,styleTween(e,t,n??""))}function textConstant(e){return function(){this.textContent=e}}function textFunction(e){return function(){var t=e(this);this.textContent=t??""}}function transition_text(e){return this.tween("text",typeof e=="function"?textFunction(tweenValue(this,"text",e)):textConstant(e==null?"":e+""))}function textInterpolate(e){return function(t){this.textContent=e.call(this,t)}}function textTween(e){var t,n;function o(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&textInterpolate(r)),t}return o._value=e,o}function transition_textTween(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,textTween(e))}function transition_transition(){for(var e=this._name,t=this._id,n=newId(),o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,l,c=0;c<a;++c)if(l=s[c]){var u=get(l,t);schedule(l,e,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Transition(o,this._parents,e,n)}function transition_end(){var e,t,n=this,o=n._id,r=n.size();return new Promise(function(i,s){var a={value:s},l={value:function(){--r===0&&i()}};n.each(function(){var c=set(this,o),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),c.on=t}),r===0&&i()})}var id=0;function Transition(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function newId(){return++id}var selection_prototype=selection.prototype;Transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,textTween:transition_textTween,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease,easeVarying:transition_easeVarying,end:transition_end,[Symbol.iterator]:selection_prototype[Symbol.iterator]};function cubicInOut(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function selection_transition(e){var t,n;e instanceof Transition?(t=e._id,e=e._name):(t=newId(),(n=defaultTiming).time=now(),e=e==null?null:e+"");for(var o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&schedule(l,e,t,c,s,n||inherit(l,t));return new Transition(o,this._parents,e,t)}selection.prototype.interrupt=selection_interrupt;selection.prototype.transition=selection_transition;const constant=e=>()=>e;function ZoomEvent(e,{sourceEvent:t,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function Transform(e,t,n){this.k=e,this.x=t,this.y=n}Transform.prototype={constructor:Transform,scale:function(e){return e===1?this:new Transform(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Transform(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var identity=new Transform(1,0,0);transform.prototype=Transform.prototype;function transform(e){for(;!e.__zoom;)if(!(e=e.parentNode))return identity;return e.__zoom}function nopropagation(e){e.stopImmediatePropagation()}function noevent(e){e.preventDefault(),e.stopImmediatePropagation()}function defaultFilter(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function defaultExtent(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function defaultTransform(){return this.__zoom||identity}function defaultWheelDelta(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function defaultConstrain(e,t,n){var o=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function zoom(){var e=defaultFilter,t=defaultExtent,n=defaultConstrain,o=defaultWheelDelta,r=defaultTouchable,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,l=interpolateZoom,c=dispatch("start","zoom","end"),u,_,f,h=500,d=150,m=0,N=10;function S(p){p.property("__zoom",defaultTransform).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",v).on("dblclick.zoom",k).filter(r).on("touchstart.zoom",X).on("touchmove.zoom",H).on("touchend.zoom touchcancel.zoom",W).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}S.transform=function(p,C,E,x){var z=p.selection?p.selection():p;z.property("__zoom",defaultTransform),p!==z?g(p,C,E,x):z.interrupt().each(function(){y(this,arguments).event(x).start().zoom(null,typeof C=="function"?C.apply(this,arguments):C).end()})},S.scaleBy=function(p,C,E,x){S.scaleTo(p,function(){var z=this.__zoom.k,F=typeof C=="function"?C.apply(this,arguments):C;return z*F},E,x)},S.scaleTo=function(p,C,E,x){S.transform(p,function(){var z=t.apply(this,arguments),F=this.__zoom,R=E==null?b(z):typeof E=="function"?E.apply(this,arguments):E,D=F.invert(R),q=typeof C=="function"?C.apply(this,arguments):C;return n(M(B(F,q),R,D),z,s)},E,x)},S.translateBy=function(p,C,E,x){S.transform(p,function(){return n(this.__zoom.translate(typeof C=="function"?C.apply(this,arguments):C,typeof E=="function"?E.apply(this,arguments):E),t.apply(this,arguments),s)},null,x)},S.translateTo=function(p,C,E,x,z){S.transform(p,function(){var F=t.apply(this,arguments),R=this.__zoom,D=x==null?b(F):typeof x=="function"?x.apply(this,arguments):x;return n(identity.translate(D[0],D[1]).scale(R.k).translate(typeof C=="function"?-C.apply(this,arguments):-C,typeof E=="function"?-E.apply(this,arguments):-E),F,s)},x,z)};function B(p,C){return C=Math.max(i[0],Math.min(i[1],C)),C===p.k?p:new Transform(C,p.x,p.y)}function M(p,C,E){var x=C[0]-E[0]*p.k,z=C[1]-E[1]*p.k;return x===p.x&&z===p.y?p:new Transform(p.k,x,z)}function b(p){return[(+p[0][0]+ +p[1][0])/2,(+p[0][1]+ +p[1][1])/2]}function g(p,C,E,x){p.on("start.zoom",function(){y(this,arguments).event(x).start()}).on("interrupt.zoom end.zoom",function(){y(this,arguments).event(x).end()}).tween("zoom",function(){var z=this,F=arguments,R=y(z,F).event(x),D=t.apply(z,F),q=E==null?b(D):typeof E=="function"?E.apply(z,F):E,V=Math.max(D[1][0]-D[0][0],D[1][1]-D[0][1]),Y=z.__zoom,L=typeof C=="function"?C.apply(z,F):C,j=l(Y.invert(q).concat(V/Y.k),L.invert(q).concat(V/L.k));return function(Q){if(Q===1)Q=L;else{var K=j(Q),te=V/K[2];Q=new Transform(te,q[0]-K[0]*te,q[1]-K[1]*te)}R.zoom(null,Q)}})}function y(p,C,E){return!E&&p.__zooming||new I(p,C)}function I(p,C){this.that=p,this.args=C,this.active=0,this.sourceEvent=null,this.extent=t.apply(p,C),this.taps=0}I.prototype={event:function(p){return p&&(this.sourceEvent=p),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(p,C){return this.mouse&&p!=="mouse"&&(this.mouse[1]=C.invert(this.mouse[0])),this.touch0&&p!=="touch"&&(this.touch0[1]=C.invert(this.touch0[0])),this.touch1&&p!=="touch"&&(this.touch1[1]=C.invert(this.touch1[0])),this.that.__zoom=C,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(p){var C=select(this.that).datum();c.call(p,this.that,new ZoomEvent(p,{sourceEvent:this.sourceEvent,target:S,type:p,transform:this.that.__zoom,dispatch:c}),C)}};function T(p,...C){if(!e.apply(this,arguments))return;var E=y(this,C).event(p),x=this.__zoom,z=Math.max(i[0],Math.min(i[1],x.k*Math.pow(2,o.apply(this,arguments)))),F=pointer(p);if(E.wheel)(E.mouse[0][0]!==F[0]||E.mouse[0][1]!==F[1])&&(E.mouse[1]=x.invert(E.mouse[0]=F)),clearTimeout(E.wheel);else{if(x.k===z)return;E.mouse=[F,x.invert(F)],interrupt(this),E.start()}noevent(p),E.wheel=setTimeout(R,d),E.zoom("mouse",n(M(B(x,z),E.mouse[0],E.mouse[1]),E.extent,s));function R(){E.wheel=null,E.end()}}function v(p,...C){if(f||!e.apply(this,arguments))return;var E=p.currentTarget,x=y(this,C,!0).event(p),z=select(p.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",V,!0),F=pointer(p,E),R=p.clientX,D=p.clientY;dragDisable(p.view),nopropagation(p),x.mouse=[F,this.__zoom.invert(F)],interrupt(this),x.start();function q(Y){if(noevent(Y),!x.moved){var L=Y.clientX-R,j=Y.clientY-D;x.moved=L*L+j*j>m}x.event(Y).zoom("mouse",n(M(x.that.__zoom,x.mouse[0]=pointer(Y,E),x.mouse[1]),x.extent,s))}function V(Y){z.on("mousemove.zoom mouseup.zoom",null),yesdrag(Y.view,x.moved),noevent(Y),x.event(Y).end()}}function k(p,...C){if(e.apply(this,arguments)){var E=this.__zoom,x=pointer(p.changedTouches?p.changedTouches[0]:p,this),z=E.invert(x),F=E.k*(p.shiftKey?.5:2),R=n(M(B(E,F),x,z),t.apply(this,C),s);noevent(p),a>0?select(this).transition().duration(a).call(g,R,x,p):select(this).call(S.transform,R,x,p)}}function X(p,...C){if(e.apply(this,arguments)){var E=p.touches,x=E.length,z=y(this,C,p.changedTouches.length===x).event(p),F,R,D,q;for(nopropagation(p),R=0;R<x;++R)D=E[R],q=pointer(D,this),q=[q,this.__zoom.invert(q),D.identifier],z.touch0?!z.touch1&&z.touch0[2]!==q[2]&&(z.touch1=q,z.taps=0):(z.touch0=q,F=!0,z.taps=1+!!u);u&&(u=clearTimeout(u)),F&&(z.taps<2&&(_=q[0],u=setTimeout(function(){u=null},h)),interrupt(this),z.start())}}function H(p,...C){if(this.__zooming){var E=y(this,C).event(p),x=p.changedTouches,z=x.length,F,R,D,q;for(noevent(p),F=0;F<z;++F)R=x[F],D=pointer(R,this),E.touch0&&E.touch0[2]===R.identifier?E.touch0[0]=D:E.touch1&&E.touch1[2]===R.identifier&&(E.touch1[0]=D);if(R=E.that.__zoom,E.touch1){var V=E.touch0[0],Y=E.touch0[1],L=E.touch1[0],j=E.touch1[1],Q=(Q=L[0]-V[0])*Q+(Q=L[1]-V[1])*Q,K=(K=j[0]-Y[0])*K+(K=j[1]-Y[1])*K;R=B(R,Math.sqrt(Q/K)),D=[(V[0]+L[0])/2,(V[1]+L[1])/2],q=[(Y[0]+j[0])/2,(Y[1]+j[1])/2]}else if(E.touch0)D=E.touch0[0],q=E.touch0[1];else return;E.zoom("touch",n(M(R,D,q),E.extent,s))}}function W(p,...C){if(this.__zooming){var E=y(this,C).event(p),x=p.changedTouches,z=x.length,F,R;for(nopropagation(p),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),F=0;F<z;++F)R=x[F],E.touch0&&E.touch0[2]===R.identifier?delete E.touch0:E.touch1&&E.touch1[2]===R.identifier&&delete E.touch1;if(E.touch1&&!E.touch0&&(E.touch0=E.touch1,delete E.touch1),E.touch0)E.touch0[1]=this.__zoom.invert(E.touch0[0]);else if(E.end(),E.taps===2&&(R=pointer(R,this),Math.hypot(_[0]-R[0],_[1]-R[1])<N)){var D=select(this).on("dblclick.zoom");D&&D.apply(this,arguments)}}}return S.wheelDelta=function(p){return arguments.length?(o=typeof p=="function"?p:constant(+p),S):o},S.filter=function(p){return arguments.length?(e=typeof p=="function"?p:constant(!!p),S):e},S.touchable=function(p){return arguments.length?(r=typeof p=="function"?p:constant(!!p),S):r},S.extent=function(p){return arguments.length?(t=typeof p=="function"?p:constant([[+p[0][0],+p[0][1]],[+p[1][0],+p[1][1]]]),S):t},S.scaleExtent=function(p){return arguments.length?(i[0]=+p[0],i[1]=+p[1],S):[i[0],i[1]]},S.translateExtent=function(p){return arguments.length?(s[0][0]=+p[0][0],s[1][0]=+p[1][0],s[0][1]=+p[0][1],s[1][1]=+p[1][1],S):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},S.constrain=function(p){return arguments.length?(n=p,S):n},S.duration=function(p){return arguments.length?(a=+p,S):a},S.interpolate=function(p){return arguments.length?(l=p,S):l},S.on=function(){var p=c.on.apply(c,arguments);return p===c?S:p},S.clickDistance=function(p){return arguments.length?(m=(p=+p)*p,S):Math.sqrt(m)},S.tapDistance=function(p){return arguments.length?(N=+p,S):N},S}function create_else_block$2(e){let t,n,o,r,i,s,a,l;return{c(){t=svg_element("g"),n=svg_element("rect"),s=svg_element("text"),a=text(e[0]),this.h()},l(c){t=claim_svg_element(c,"g",{});var u=children$1(t);n=claim_svg_element(u,"rect",{class:!0,"data-testid":!0,fill:!0,x:!0,y:!0,width:!0,height:!0}),children$1(n).forEach(detach),s=claim_svg_element(u,"text",{class:!0,x:!0,y:!0,"font-size":!0,"dominant-baseline":!0,"text-anchor":!0,fill:!0});var _=children$1(s);a=claim_text(_,e[0]),_.forEach(detach),u.forEach(detach),this.h()},h(){attr(n,"class","EdgeTextBg"),attr(n,"data-testid","edge-text-bg"),attr(n,"fill",o=e[5]?e[5]:"white"),attr(n,"x",r=e[3]-e[1]/2),attr(n,"y",i=e[2]-shiftRectY),attr(n,"width",e[1]),attr(n,"height",16),attr(s,"class","EdgeText"),attr(s,"x",e[3]),attr(s,"y",e[2]),attr(s,"font-size","12px"),attr(s,"dominant-baseline","central"),attr(s,"text-anchor","middle"),attr(s,"fill",l=e[4]?e[4]:"black")},m(c,u){insert_hydration(c,t,u),append_hydration(t,n),append_hydration(t,s),append_hydration(s,a)},p(c,u){u&32&&o!==(o=c[5]?c[5]:"white")&&attr(n,"fill",o),u&10&&r!==(r=c[3]-c[1]/2)&&attr(n,"x",r),u&4&&i!==(i=c[2]-shiftRectY)&&attr(n,"y",i),u&2&&attr(n,"width",c[1]),u&1&&set_data(a,c[0]),u&8&&attr(s,"x",c[3]),u&4&&attr(s,"y",c[2]),u&16&&l!==(l=c[4]?c[4]:"black")&&attr(s,"fill",l)},d(c){c&&detach(t)}}}function create_if_block$5(e){let t=null+"",n;return{c(){n=text(t)},l(o){n=claim_text(o,t)},m(o,r){insert_hydration(o,n,r)},p:noop$1,d(o){o&&detach(n)}}}function create_fragment$k(e){let t;function n(i,s){return typeof i[0]>"u"||!i[0]?create_if_block$5:create_else_block$2}let o=n(e),r=o(e);return{c(){r.c(),t=empty$1()},l(i){r.l(i),t=empty$1()},m(i,s){r.m(i,s),insert_hydration(i,t,s)},p(i,[s]){o===(o=n(i))&&r?r.p(i,s):(r.d(1),r=o(i),r&&(r.c(),r.m(t.parentNode,t)))},i:noop$1,o:noop$1,d(i){r.d(i),i&&detach(t)}}}const shiftRectY=7;function instance$k(e,t,n){let o,r,i,s,a,l,c,u,_,f,h,{edgeTextProps:d}=t;return e.$$set=m=>{"edgeTextProps"in m&&n(6,d=m.edgeTextProps)},e.$$.update=()=>{e.$$.dirty&64&&n(0,{label:o,labelBgColor:r,labelTextColor:i,centerX:s,centerY:a}=d,o,(n(5,r),n(6,d)),(n(4,i),n(6,d)),(n(11,s),n(6,d)),(n(10,a),n(6,d))),e.$$.dirty&1&&n(7,l=o.length<3?9:7),e.$$.dirty&2048&&n(3,c=s),e.$$.dirty&1024&&n(2,u=a),e.$$.dirty&1&&n(9,_=o.split(" ").length-1),e.$$.dirty&513&&n(8,f=o.length-_),e.$$.dirty&384&&n(1,h=f*l)},[o,h,u,c,i,r,d,l,f,_,a,s]}class EdgeText extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$k,create_fragment$k,safe_not_equal,{edgeTextProps:6})}}const BaseEdge_svelte_svelte_type_style_lang="";function create_if_block_2$1(e){let t,n,o;return{c(){t=svg_element("path"),this.h()},l(r){t=claim_svg_element(r,"path",{id:!0,d:!0,fill:!0,stroke:!0,"stroke-opacity":!0,"stroke-width":!0,class:!0}),children$1(t).forEach(detach),this.h()},h(){attr(t,"id","edgeSelector"),attr(t,"d",e[4]),attr(t,"fill","transparent"),attr(t,"stroke","red"),attr(t,"stroke-opacity","0"),attr(t,"stroke-width","20"),attr(t,"class","svelte-7tz672")},m(r,i){insert_hydration(r,t,i),n||(o=[listen(t,"contextmenu",e[7]),listen(t,"click",e[8]),listen(t,"keypress",keypress_handler)],n=!0)},p(r,i){i&16&&attr(t,"d",r[4])},d(r){r&&detach(t),n=!1,run_all(o)}}}function create_else_block$1(e){let t,n,o;return{c(){t=svg_element("path"),this.h()},l(r){t=claim_svg_element(r,"path",{class:!0,d:!0,fill:!0,stroke:!0,"aria-label":!0}),children$1(t).forEach(detach),this.h()},h(){attr(t,"class",n=null_to_empty(e[3]?`animate ${e[5].className}`:`${e[5].className}`)+" svelte-7tz672"),attr(t,"d",e[4]),attr(t,"fill","transparent"),attr(t,"stroke",o=e[1]?e[1]:"gray"),attr(t,"aria-label","svg-path")},m(r,i){insert_hydration(r,t,i)},p(r,i){i&8&&n!==(n=null_to_empty(r[3]?`animate ${r[5].className}`:`${r[5].className}`)+" svelte-7tz672")&&attr(t,"class",n),i&16&&attr(t,"d",r[4]),i&2&&o!==(o=r[1]?r[1]:"gray")&&attr(t,"stroke",o)},d(r){r&&detach(t)}}}function create_if_block_1$2(e){let t,n,o;return{c(){t=svg_element("path"),this.h()},l(r){t=claim_svg_element(r,"path",{class:!0,d:!0,fill:!0,stroke:!0,"marker-end":!0,"aria-label":!0}),children$1(t).forEach(detach),this.h()},h(){attr(t,"class",n=null_to_empty(e[3]?`animate ${e[5].className}`:`${e[5].className}`)+" svelte-7tz672"),attr(t,"d",e[4]),attr(t,"fill","transparent"),attr(t,"stroke",o=e[1]?e[1]:"gray"),attr(t,"marker-end","url(#arrow)"),attr(t,"aria-label","svg-path")},m(r,i){insert_hydration(r,t,i)},p(r,i){i&8&&n!==(n=null_to_empty(r[3]?`animate ${r[5].className}`:`${r[5].className}`)+" svelte-7tz672")&&attr(t,"class",n),i&16&&attr(t,"d",r[4]),i&2&&o!==(o=r[1]?r[1]:"gray")&&attr(t,"stroke",o)},d(r){r&&detach(t)}}}function create_if_block$4(e){let t,n;return t=new EdgeText({props:{edgeTextProps:e[0]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r&1&&(i.edgeTextProps=o[0]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_fragment$j(e){let t,n,o,r,i,s,a,l,c=e[6]&&create_if_block_2$1(e);function u(d,m){return d[2]?create_if_block_1$2:create_else_block$1}let _=u(e),f=_(e),h=e[0].label&&create_if_block$4(e);return{c(){t=svg_element("defs"),n=svg_element("marker"),o=svg_element("polygon"),r=space(),c&&c.c(),i=space(),f.c(),s=space(),h&&h.c(),a=empty$1(),this.h()},l(d){t=claim_svg_element(d,"defs",{});var m=children$1(t);n=claim_svg_element(m,"marker",{id:!0,markerWidth:!0,markerHeight:!0,refX:!0,refY:!0,orient:!0});var N=children$1(n);o=claim_svg_element(N,"polygon",{points:!0,fill:!0}),children$1(o).forEach(detach),N.forEach(detach),m.forEach(detach),r=claim_space(d),c&&c.l(d),i=claim_space(d),f.l(d),s=claim_space(d),h&&h.l(d),a=empty$1(),this.h()},h(){attr(o,"points",e[9]),attr(o,"fill","gray"),attr(n,"id","arrow"),attr(n,"markerWidth","9"),attr(n,"markerHeight","9"),attr(n,"refX","8"),attr(n,"refY","4"),attr(n,"orient","auto")},m(d,m){insert_hydration(d,t,m),append_hydration(t,n),append_hydration(n,o),insert_hydration(d,r,m),c&&c.m(d,m),insert_hydration(d,i,m),f.m(d,m),insert_hydration(d,s,m),h&&h.m(d,m),insert_hydration(d,a,m),l=!0},p(d,[m]){d[6]&&c.p(d,m),_===(_=u(d))&&f?f.p(d,m):(f.d(1),f=_(d),f&&(f.c(),f.m(s.parentNode,s))),d[0].label?h?(h.p(d,m),m&1&&transition_in(h,1)):(h=create_if_block$4(d),h.c(),transition_in(h,1),h.m(a.parentNode,a)):h&&(group_outros(),transition_out(h,1,1,()=>{h=null}),check_outros())},i(d){l||(transition_in(h),l=!0)},o(d){transition_out(h),l=!1},d(d){d&&detach(t),d&&detach(r),c&&c.d(d),d&&detach(i),f.d(d),d&&detach(s),h&&h.d(d),d&&detach(a)}}}const keypress_handler=()=>{};function instance$j(e,t,n){let o,r,i,s,a,l,c,u,_,f,{baseEdgeProps:h}=t,{canvasId:d}=t;const m=h.id,N=findStore(d),S=getEdgeById(N,m),B=get_store_value(N.highlightEdgesOption),M=()=>{const y=findStore(d),{editableOption:I}=y;get_store_value(I)&&y.edgeEditModal.set(m)},b=()=>{const y=findStore(d),I=getEdgeById(y,m);I.clickCallback&&I.clickCallback(I),console.log(I.className)},g="0 0, 9 4.5, 0 9";return e.$$set=y=>{"baseEdgeProps"in y&&n(10,h=y.baseEdgeProps),"canvasId"in y&&n(11,d=y.canvasId)},e.$$.update=()=>{e.$$.dirty&1024&&n(4,{path:o,animate:r,arrow:i,label:s,labelBgColor:a,labelTextColor:l,edgeColor:c,centerX:u,centerY:_}=h,o,(n(3,r),n(10,h)),(n(2,i),n(10,h)),(n(16,s),n(10,h)),(n(15,a),n(10,h)),(n(14,l),n(10,h)),(n(1,c),n(10,h)),(n(13,u),n(10,h)),(n(12,_),n(10,h))),e.$$.dirty&126976&&n(0,f={label:s,labelBgColor:a,labelTextColor:l,centerX:u,centerY:_})},[f,c,i,r,o,S,B,M,b,g,h,d,_,u,l,a,s]}class BaseEdge extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$j,create_fragment$j,safe_not_equal,{baseEdgeProps:10,canvasId:11})}}function create_fragment$i(e){let t,n;return t=new BaseEdge({props:{baseEdgeProps:e[1],canvasId:e[0]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,[r]){const i={};r&2&&(i.baseEdgeProps=o[1]),r&1&&(i.canvasId=o[0]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function calculateControlOffset(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function instance$i(e,t,n){let o,r,i,s,a;const l={};l.Left="left",l.Right="right",l.Top="top",l.Bottom="bottom";function c({pos:b,x1:g,y1:y,x2:I,y2:T,c:v}){let k,X;switch(b){case l.Left:k=g-calculateControlOffset(g-I,v),X=y;break;case l.Right:k=g+calculateControlOffset(I-g,v),X=y;break;case l.Top:k=g,X=y-calculateControlOffset(y-T,v);break;case l.Bottom:k=g,X=y+calculateControlOffset(T-y,v);break}return[k,X]}function u({sourceX:b,sourceY:g,sourcePosition:y=l.Bottom,targetX:I,targetY:T,targetPosition:v=l.Top,curvature:k=.25}){const[X,H]=c({pos:y,x1:b,y1:g,x2:I,y2:T,c:k}),[W,p]=c({pos:v,x1:I,y1:T,x2:b,y2:g,c:k});return`M${b},${g} C${X},${H} ${W},${p} ${I},${T}`}function _({sourceX:b,sourceY:g,sourcePosition:y=l.Bottom,targetX:I,targetY:T,targetPosition:v=l.Top,curvature:k=.25}){const[X,H]=c({pos:y,x1:b,y1:g,x2:I,y2:T,c:k}),[W,p]=c({pos:v,x1:I,y1:T,x2:b,y2:g,c:k}),C=b*.125+X*.375+W*.375+I*.125,E=g*.125+H*.375+p*.375+T*.125,x=Math.abs(C-b),z=Math.abs(E-g);return[C,E,x,z]}let{canvasId:f}=t,{edgeId:h}=t;const d=findStore(f),{nodesStore:m,edgesStore:N,anchorsStore:S}=d;component_subscribe(e,N,b=>n(9,a=b));let B,M;return e.$$set=b=>{"canvasId"in b&&n(0,f=b.canvasId),"edgeId"in b&&n(3,h=b.edgeId)},e.$$.update=()=>{if(e.$$.dirty&520&&n(4,B=a[h]),e.$$.dirty&17){const b=findStore(f),g=getAnchorFromEdge(b,B.id,"source"),y=getAnchorFromEdge(b,B.id,"target"),I={0:"right",90:"top",180:"left",270:"bottom"};n(5,M={sourceX:B.sourceX,sourceY:B.sourceY,sourcePosition:I[g.angle],targetX:B.targetX,targetY:B.targetY,targetPosition:I[y.angle],curvature:.25})}e.$$.dirty&32&&n(8,o=u(M)),e.$$.dirty&32&&n(7,[r,i]=_(M),r,(n(6,i),n(5,M),n(0,f),n(4,B),n(9,a),n(3,h))),e.$$.dirty&464&&n(1,s={...B,path:o,centerX:r,centerY:i})},[f,s,N,h,B,M,i,r,o,a]}class SimpleBezierEdge extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$i,create_fragment$i,safe_not_equal,{canvasId:0,edgeId:3})}}var Position;(function(e){e.Left="left",e.Right="right",e.Top="top",e.Bottom="bottom"})(Position||(Position={}));const LeftOrRight=[Position.Left,Position.Right],getCenter=({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:r=Position.Bottom,targetPosition:i=Position.Top})=>{const s=LeftOrRight.includes(r),a=LeftOrRight.includes(i);if(s&&!a||a&&!s){const h=s?Math.abs(n-e):0,d=e>n?e-h:e+h,m=s?0:Math.abs(o-t),N=t<o?t+m:t-m;return[d,N,h,m]}const c=Math.abs(n-e)/2,u=n<e?n+c:n-c,_=Math.abs(o-t)/2,f=o<t?o+_:o-_;return[u,f,c,_]};function create_fragment$h(e){let t,n;return t=new BaseEdge({props:{baseEdgeProps:e[1],canvasId:e[0]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,[r]){const i={};r&2&&(i.baseEdgeProps=o[1]),r&1&&(i.canvasId=o[0]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function instance$h(e,t,n){let o,r,i,s;const a={};a.Left="left",a.Right="right",a.Top="top",a.Bottom="bottom";const l=(g,y,I)=>`L ${g},${y-I}Q ${g},${y} ${g+I},${y}`,c=(g,y,I)=>`L ${g+I},${y}Q ${g},${y} ${g},${y-I}`,u=(g,y,I)=>`L ${g},${y-I}Q ${g},${y} ${g-I},${y}`,_=(g,y,I)=>`L ${g-I},${y}Q ${g},${y} ${g},${y-I}`,f=(g,y,I)=>`L ${g+I},${y}Q ${g},${y} ${g},${y+I}`,h=(g,y,I)=>`L ${g},${y+I}Q ${g},${y} ${g+I},${y}`,d=(g,y,I)=>`L ${g},${y+I}Q ${g},${y} ${g-I},${y}`,m=(g,y,I)=>`L ${g-I},${y}Q ${g},${y} ${g},${y+I}`;function N({sourceX:g,sourceY:y,sourcePosition:I=a.Bottom,targetX:T,targetY:v,targetPosition:k=a.Top,borderRadius:X=5,centerX:H,centerY:W}){const[p,C,E,x]=getCenter({sourceX:g,sourceY:y,targetX:T,targetY:v}),z=Math.min(X,Math.abs(T-g)),F=Math.min(X,Math.abs(v-y)),R=Math.min(z,F,E,x),D=[a.Left,a.Right],q=typeof H<"u"?H:p,V=typeof W<"u"?W:C;let Y=null,L=null;return g<=T?(Y=y<=v?l(g,V,R):h(g,V,R),L=y<=v?m(T,V,R):_(T,V,R)):(Y=y<v?u(g,V,R):d(g,V,R),L=y<v?f(T,V,R):c(T,V,R)),D.includes(I)&&D.includes(k)?g<=T?(Y=y<=v?m(q,y,R):_(q,y,R),L=y<=v?l(q,v,R):h(q,v,R)):(I===a.Right&&k===a.Left||I===a.Left&&k===a.Right||I===a.Left&&k===a.Left)&&(Y=y<=v?f(q,y,R):c(q,y,R),L=y<=v?u(q,v,R):d(q,v,R)):D.includes(I)&&!D.includes(k)?(g<=T?Y=y<=v?m(T,y,R):_(T,y,R):Y=y<=v?f(T,y,R):c(T,y,R),L=""):!D.includes(I)&&D.includes(k)&&(g<=T?Y=y<=v?l(g,v,R):h(g,v,R):Y=y<=v?u(g,v,R):d(g,v,R),L=""),`M ${g},${y}${Y}${L}L ${T},${v}`}let{edge:S}=t,{borderRadius:B=5}=t,{canvasId:M}=t,b;return e.$$set=g=>{"edge"in g&&n(3,S=g.edge),"borderRadius"in g&&n(4,B=g.borderRadius),"canvasId"in g&&n(0,M=g.canvasId)},e.$$.update=()=>{if(e.$$.dirty&25){const g=findStore(M),y=getAnchorFromEdge(g,S.id,"source"),I=getAnchorFromEdge(g,S.id,"target"),T={0:"right",90:"top",180:"left",270:"bottom"};n(5,b={sourceX:S.sourceX,sourceY:S.sourceY,targetX:S.targetX,targetY:S.targetY,sourcePosition:T[y.angle],targetPosition:T[I.angle],borderRadius:B})}e.$$.dirty&32&&n(7,[o,r]=getCenter(b),o,(n(6,r),n(5,b),n(0,M),n(3,S),n(4,B))),e.$$.dirty&32&&n(8,i=N(b)),e.$$.dirty&456&&n(1,s={...S,path:i,centerX:o,centerY:r})},[M,s,N,S,B,b,r,o,i]}class SmoothStepEdge extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$h,create_fragment$h,safe_not_equal,{getSmoothStepPath:2,edge:3,borderRadius:4,canvasId:0})}get getSmoothStepPath(){return this.$$.ctx[2]}}function create_fragment$g(e){let t,n;return t=new SmoothStepEdge({props:{edge:e[0],borderRadius:0,canvasId:e[1]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,[r]){const i={};r&1&&(i.edge=o[0]),r&2&&(i.canvasId=o[1]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function instance$g(e,t,n){let{edge:o}=t,{canvasId:r}=t;return e.$$set=i=>{"edge"in i&&n(0,o=i.edge),"canvasId"in i&&n(1,r=i.canvasId)},[o,r]}class StepEdge extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$g,create_fragment$g,safe_not_equal,{edge:0,canvasId:1})}}function create_fragment$f(e){let t,n;return t=new BaseEdge({props:{baseEdgeProps:e[1],canvasId:e[0]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,[r]){const i={};r&2&&(i.baseEdgeProps=o[1]),r&1&&(i.canvasId=o[0]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function instance$f(e,t,n){let o,r,i,s,a,l,c,u,{edgeId:_}=t,{canvasId:f}=t;const h=findStore(f),{nodesStore:d,edgesStore:m,anchorsStore:N}=h;return component_subscribe(e,m,S=>n(10,u=S)),e.$$set=S=>{"edgeId"in S&&n(3,_=S.edgeId),"canvasId"in S&&n(0,f=S.canvasId)},e.$$.update=()=>{e.$$.dirty&1032&&n(7,o=u[_]),e.$$.dirty&128&&n(6,r=`M ${o.sourceX},${o.sourceY}L ${o.targetX},${o.targetY}`),e.$$.dirty&128&&n(9,i=Math.abs(o.targetX-o.sourceX)/2),e.$$.dirty&128&&n(8,s=Math.abs(o.targetY-o.sourceY)/2),e.$$.dirty&640&&n(5,a=o.targetX<o.sourceX?o.targetX+i:o.targetX-i),e.$$.dirty&384&&n(4,l=o.targetY<o.sourceY?o.targetY+s:o.targetY-s),e.$$.dirty&240&&n(1,c={...o,path:r,centerX:a,centerY:l})},[f,c,m,_,l,a,r,o,s,i,u]}class StraightEdge extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$f,create_fragment$f,safe_not_equal,{edgeId:3,canvasId:0})}}const EdgeAnchor_svelte_svelte_type_style_lang="";function create_fragment$e(e){let t;return{c(){t=svg_element("circle"),this.h()},l(n){t=claim_svg_element(n,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,fill:!0,class:!0}),children$1(t).forEach(detach),this.h()},h(){attr(t,"cx",e[0]),attr(t,"cy",e[1]),attr(t,"r",5),attr(t,"stroke","white"),attr(t,"fill","black"),attr(t,"class","svelte-1ulqurc")},m(n,o){insert_hydration(n,t,o)},p(n,[o]){o&1&&attr(t,"cx",n[0]),o&2&&attr(t,"cy",n[1])},i:noop$1,o:noop$1,d(n){n&&detach(t)}}}function instance$e(e,t,n){let{x:o}=t,{y:r}=t;return e.$$set=i=>{"x"in i&&n(0,o=i.x),"y"in i&&n(1,r=i.y)},[o,r]}class EdgeAnchor extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$e,create_fragment$e,safe_not_equal,{x:0,y:1})}}const ResizeNode_svelte_svelte_type_style_lang="";function create_fragment$d(e){let t,n,o,r;return{c(){t=element("div"),this.h()},l(i){t=claim_element(i,"DIV",{class:!0,style:!0,id:!0}),children$1(t).forEach(detach),this.h()},h(){attr(t,"class","ResizeNode svelte-1g55lj2"),set_style(t,"left",e[2].positionX-10+"px"),set_style(t,"top",e[2].positionY-10+"px"),set_style(t,"width","20px"),set_style(t,"height","20px"),set_style(t,"background-color","purple"),set_style(t,"border-color","purple"),set_style(t,"border-radius","50%"),attr(t,"id",n="svelvet-"+e[0])},m(i,s){insert_hydration(i,t,s),o||(r=[listen(window,"mousemove",e[11]),listen(window,"mouseup",e[12]),listen(t,"mousedown",e[13]),listen(t,"mouseover",e[14]),listen(t,"focus",e[9]),listen(t,"mouseleave",e[15]),listen(t,"mouseenter",e[16]),listen(t,"wheel",prevent_default(e[10]))],o=!0)},p(i,[s]){s&4&&set_style(t,"left",i[2].positionX-10+"px"),s&4&&set_style(t,"top",i[2].positionY-10+"px"),s&1&&n!==(n="svelvet-"+i[0])&&attr(t,"id",n)},i:noop$1,o:noop$1,d(i){i&&detach(t),o=!1,run_all(r)}}}function instance$d(e,t,n){let o,r,{resizeId:i}=t,{canvasId:s}=t;const a=findStore(s),{resizeNodesStore:l,nodeSelected:c}=a;component_subscribe(e,l,b=>n(8,o=b)),component_subscribe(e,c,b=>n(3,r=b));let u=!1,_;function f(b){bubble.call(this,e,b)}function h(b){bubble.call(this,e,b)}const d=b=>{b.preventDefault(),u&&l.update(g=>{const y=g[i],I=get_store_value(a.d3Scale);return y.setPositionAndCascade(b.movementX/I,b.movementY/I,i),{...g}})},m=b=>{b.preventDefault(),n(1,u=!1)},N=b=>{b.preventDefault(),set_store_value(c,r=!0,r),n(1,u=!0)},S=b=>set_store_value(c,r=!0,r),B=b=>set_store_value(c,r=!1,r),M=b=>set_store_value(c,r=!0,r);return e.$$set=b=>{"resizeId"in b&&n(0,i=b.resizeId),"canvasId"in b&&n(7,s=b.canvasId)},e.$$.update=()=>{e.$$.dirty&257&&n(2,_=o[i])},[i,u,_,r,a,l,c,s,o,f,h,d,m,N,S,B,M]}class ResizeNode extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$d,create_fragment$d,safe_not_equal,{resizeId:0,canvasId:7})}}const EditNode_svelte_svelte_type_style_lang="";function create_if_block$3(e){let t,n,o,r,i,s,a,l,c,u,_,f,h,d,m,N,S,B,M,b,g,y,I,T,v,k;return{c(){t=element("div"),n=element("form"),o=element("label"),r=text("Label"),i=space(),s=element("input"),c=space(),u=element("label"),_=text("Background Color"),f=space(),h=element("input"),m=space(),N=element("input"),B=space(),M=element("div"),b=element("button"),g=text("Delete Node"),y=space(),I=element("button"),T=text("Submit"),this.h()},l(X){t=claim_element(X,"DIV",{class:!0,style:!0});var H=children$1(t);n=claim_element(H,"FORM",{class:!0});var W=children$1(n);o=claim_element(W,"LABEL",{for:!0,class:!0});var p=children$1(o);r=claim_text(p,"Label"),p.forEach(detach),i=claim_space(W),s=claim_element(W,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0}),c=claim_space(W),u=claim_element(W,"LABEL",{for:!0,class:!0});var C=children$1(u);_=claim_text(C,"Background Color"),C.forEach(detach),f=claim_space(W),h=claim_element(W,"INPUT",{type:!0,id:!0,class:!0}),m=claim_space(W),N=claim_element(W,"INPUT",{type:!0,placeholder:!0,class:!0}),W.forEach(detach),B=claim_space(H),M=claim_element(H,"DIV",{class:!0});var E=children$1(M);b=claim_element(E,"BUTTON",{class:!0});var x=children$1(b);g=claim_text(x,"Delete Node"),x.forEach(detach),y=claim_space(E),I=claim_element(E,"BUTTON",{class:!0});var z=children$1(I);T=claim_text(z,"Submit"),z.forEach(detach),E.forEach(detach),H.forEach(detach),this.h()},h(){attr(o,"for","label-input"),attr(o,"class","svelte-1rprzpr"),attr(s,"type","text"),attr(s,"id",a="label-input-"+e[1]),attr(s,"placeholder",l=e[5].data.label),attr(s,"class","svelte-1rprzpr"),attr(u,"for","bg-color-input"),attr(u,"class","svelte-1rprzpr"),attr(h,"type","color"),attr(h,"id",d="bg-color-input-"+e[1]),attr(h,"class","bgci svelte-1rprzpr"),attr(N,"type","text"),attr(N,"placeholder",S=e[5].bgColor),attr(N,"class","svelte-1rprzpr"),attr(n,"class","svelte-1rprzpr"),attr(b,"class","svelte-1rprzpr"),attr(I,"class","svelte-1rprzpr"),attr(M,"class","btn-container svelte-1rprzpr"),attr(t,"class","EditNode svelte-1rprzpr"),set_style(t,"left",e[5].positionX+e[5].width+"px"),set_style(t,"top",e[5].positionY+"px")},m(X,H){insert_hydration(X,t,H),append_hydration(t,n),append_hydration(n,o),append_hydration(o,r),append_hydration(n,i),append_hydration(n,s),set_input_value(s,e[3]),append_hydration(n,c),append_hydration(n,u),append_hydration(u,_),append_hydration(n,f),append_hydration(n,h),set_input_value(h,e[4]),append_hydration(n,m),append_hydration(n,N),set_input_value(N,e[4]),append_hydration(t,B),append_hydration(t,M),append_hydration(M,b),append_hydration(b,g),append_hydration(M,y),append_hydration(M,I),append_hydration(I,T),v||(k=[listen(s,"input",e[12]),listen(h,"input",e[13]),listen(N,"input",e[14]),listen(n,"submit",e[9]),listen(b,"click",e[15]),listen(I,"click",e[16]),listen(t,"mouseover",e[17]),listen(t,"focus",e[10]),listen(t,"wheel",prevent_default(e[11]))],v=!0)},p(X,H){H&2&&a!==(a="label-input-"+X[1])&&attr(s,"id",a),H&32&&l!==(l=X[5].data.label)&&attr(s,"placeholder",l),H&8&&s.value!==X[3]&&set_input_value(s,X[3]),H&2&&d!==(d="bg-color-input-"+X[1])&&attr(h,"id",d),H&16&&set_input_value(h,X[4]),H&32&&S!==(S=X[5].bgColor)&&attr(N,"placeholder",S),H&16&&N.value!==X[4]&&set_input_value(N,X[4]),H&32&&set_style(t,"left",X[5].positionX+X[5].width+"px"),H&32&&set_style(t,"top",X[5].positionY+"px")},d(X){X&&detach(t),v=!1,run_all(k)}}}function create_fragment$c(e){let t,n=e[0]&&create_if_block$3(e);return{c(){n&&n.c(),t=empty$1()},l(o){n&&n.l(o),t=empty$1()},m(o,r){n&&n.m(o,r),insert_hydration(o,t,r)},p(o,[r]){o[0]?n?n.p(o,r):(n=create_if_block$3(o),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:noop$1,o:noop$1,d(o){n&&n.d(o),o&&detach(t)}}}function instance$c(e,t,n){let o,r,{nodeId:i}=t,{canvasId:s}=t,{isEditing:a}=t,l,c,u,_;const f=findStore(s),{nodesStore:h,nodeSelected:d}=f;component_subscribe(e,h,v=>n(21,o=v)),component_subscribe(e,d,v=>n(6,r=v));let m=o[i];const N=v=>{v.preventDefault(),l&&n(5,m.data.label=l,m),c&&n(5,m.width=c,m),u&&n(5,m.height=u,m),_&&n(5,m.bgColor=_,m),c="",u="",n(3,l=""),f.nodesStore.set(o)};function S(v){bubble.call(this,e,v)}function B(v){bubble.call(this,e,v)}function M(){l=this.value,n(3,l)}function b(){_=this.value,n(4,_)}function g(){_=this.value,n(4,_)}const y=v=>{const k=findStore(s);getNodeById(k,i).delete(),n(0,a=!1)},I=v=>{N(v),n(0,a=!1)},T=v=>set_store_value(d,r=!0,r);return e.$$set=v=>{"nodeId"in v&&n(1,i=v.nodeId),"canvasId"in v&&n(2,s=v.canvasId),"isEditing"in v&&n(0,a=v.isEditing)},[a,i,s,l,_,m,r,h,d,N,S,B,M,b,g,y,I,T]}class EditNode extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$c,create_fragment$c,safe_not_equal,{nodeId:1,canvasId:2,isEditing:0})}}const forceCssHeightAndWidth=(e,t)=>{let n,o,r;for(let i=0;i<document.styleSheets.length;i++){const a=document.styleSheets[i].cssRules;for(let l=0;l<a.length;l++){const c=a[l];if(c instanceof CSSStyleRule&&c.selectorText===`.${t.className}`){const u=c.cssText,_=u.indexOf("{");r=u.substring(_+1,u.length-1);const f=r.split(" ");f.forEach((h,d)=>{h==="width:"&&(n=h.concat(f[d+1]),n=parseInt(f[d+1])),h==="height:"&&(o=h.concat(f[d+1]),o=parseInt(f[d+1]))})}}}e.nodesStore.update(i=>(n!==void 0&&(i[t.id].width=n),o!==void 0&&(i[t.id].height=o),{...i})),t.setPositionFromMovement(0,0),e.resizeNodesStore.update(i=>{for(let s of Object.values(i))s.nodeId===t.id&&(s.positionX=t.positionX+t.width,s.positionY=t.positionY+t.height);return{...i}})},Node_svelte_svelte_type_style_lang="";function create_if_block_1$1(e){let t,n;return t=new EditNode({props:{canvasId:e[1],nodeId:e[2],isEditing:e[3]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r&2&&(i.canvasId=o[1]),r&4&&(i.nodeId=o[2]),r&8&&(i.isEditing=o[3]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_if_block$2(e){let t,n;return{c(){t=element("img"),this.h()},l(o){t=claim_element(o,"IMG",{src:!0,alt:!0,style:!0,class:!0}),this.h()},h(){src_url_equal(t.src,n=e[0].src)||attr(t,"src",n),attr(t,"alt",""),set_style(t,"width",e[0].width*.75+"px"),set_style(t,"height",e[0].height*.75+"px"),set_style(t,"overflow","hidden"),attr(t,"class","svelte-g3bkh5")},m(o,r){insert_hydration(o,t,r)},p(o,r){r&1&&!src_url_equal(t.src,n=o[0].src)&&attr(t,"src",n),r&1&&set_style(t,"width",o[0].width*.75+"px"),r&1&&set_style(t,"height",o[0].height*.75+"px")},d(o){o&&detach(t)}}}function create_fragment$b(e){let t,n,o,r,i,s,a,l,c=e[3]&&e[4]&&create_if_block_1$1(e),u=e[0].image&&create_if_block$2(e);const _=e[18].default,f=create_slot(_,e,e[17],null);return{c(){c&&c.c(),t=space(),n=element("div"),u&&u.c(),o=space(),f&&f.c(),this.h()},l(h){c&&c.l(h),t=claim_space(h),n=claim_element(h,"DIV",{class:!0,style:!0,id:!0});var d=children$1(n);u&&u.l(d),o=claim_space(d),f&&f.l(d),d.forEach(detach),this.h()},h(){attr(n,"class",r="Node "+e[0].className+" svelte-g3bkh5"),set_style(n,"left",e[0].positionX+"px"),set_style(n,"top",e[0].positionY+"px"),set_style(n,"width",e[0].width+"px"),set_style(n,"height",e[0].height+"px"),set_style(n,"background-color",e[0].bgColor),set_style(n,"border-color",e[0].borderColor),set_style(n,"border-radius",e[0].borderRadius+"px"),set_style(n,"color",e[0].textColor),set_style(n,"cursor",e[5]?"default":"grab"),attr(n,"id",i="svelvet-"+e[0].id)},m(h,d){c&&c.m(h,d),insert_hydration(h,t,d),insert_hydration(h,n,d),u&&u.m(n,null),append_hydration(n,o),f&&f.m(n,null),s=!0,a||(l=[listen(window,"mousemove",e[14]),listen(window,"mouseup",e[16]),listen(n,"mouseleave",e[12]),listen(n,"mousedown",e[10]),listen(n,"contextmenu",e[11]),listen(n,"touchmove",e[15]),listen(n,"touchstart",e[10]),listen(n,"touchend",e[16]),listen(n,"mouseenter",e[13]),listen(n,"wheel",wheel_handler)],a=!0)},p(h,[d]){h[3]&&h[4]?c?(c.p(h,d),d&24&&transition_in(c,1)):(c=create_if_block_1$1(h),c.c(),transition_in(c,1),c.m(t.parentNode,t)):c&&(group_outros(),transition_out(c,1,1,()=>{c=null}),check_outros()),h[0].image?u?u.p(h,d):(u=create_if_block$2(h),u.c(),u.m(n,o)):u&&(u.d(1),u=null),f&&f.p&&(!s||d&131072)&&update_slot_base(f,_,h,h[17],s?get_slot_changes(_,h[17],d,null):get_all_dirty_from_scope(h[17]),null),(!s||d&1&&r!==(r="Node "+h[0].className+" svelte-g3bkh5"))&&attr(n,"class",r),(!s||d&1)&&set_style(n,"left",h[0].positionX+"px"),(!s||d&1)&&set_style(n,"top",h[0].positionY+"px"),(!s||d&1)&&set_style(n,"width",h[0].width+"px"),(!s||d&1)&&set_style(n,"height",h[0].height+"px"),(!s||d&1)&&set_style(n,"background-color",h[0].bgColor),(!s||d&1)&&set_style(n,"border-color",h[0].borderColor),(!s||d&1)&&set_style(n,"border-radius",h[0].borderRadius+"px"),(!s||d&1)&&set_style(n,"color",h[0].textColor),(!s||d&32)&&set_style(n,"cursor",h[5]?"default":"grab"),(!s||d&1&&i!==(i="svelvet-"+h[0].id))&&attr(n,"id",i)},i(h){s||(transition_in(c),transition_in(f,h),s=!0)},o(h){transition_out(c),transition_out(f,h),s=!1},d(h){c&&c.d(h),h&&detach(t),h&&detach(n),u&&u.d(),f&&f.d(h),a=!1,run_all(l)}}}const wheel_handler=e=>e.preventDefault();function instance$b(e,t,n){let o,r,i,s,a,{$$slots:l={},$$scope:c}=t,{node:u}=t,{canvasId:_}=t,{nodeId:f}=t;const h=findStore(_),{nodesStore:d,edgesStore:m,anchorsStore:N,nodeSelected:S,resizeNodesStore:B,editableOption:M,lockedOption:b}=h;component_subscribe(e,d,p=>n(22,i=p)),component_subscribe(e,S,p=>n(21,r=p)),component_subscribe(e,M,p=>n(4,s=p)),component_subscribe(e,b,p=>n(5,a=p));let g=!1;afterUpdate(()=>{u.className&&forceCssHeightAndWidth(h,u)});let y=!1;const I=p=>{y=!0,toggleExpandAndCollapse(h,f),set_store_value(S,r=!0,r),g=!0},T=p=>{p.preventDefault(),n(0,u=i[f]),set_store_value(S,r=!0,r),g=!1,n(3,o=o!==!0)},v=p=>{y=!1,set_store_value(S,r=!1,r)},k=p=>{S.set(!0)},X=p=>{p.preventDefault(),y=!1,g&&d.update(C=>{const E=C[f],x=get_store_value(h.d3Scale);return E.setPositionFromMovement(p.movementX/x,p.movementY/x),{...C}})},H=p=>{p.preventDefault(),y=!1,g&&d.update(C=>{const E=C[f],{x,y:z,width:F,height:R}=p.target.getBoundingClientRect(),D=(p.touches[0].clientX-x)/F*p.target.offsetWidth,q=(p.touches[0].clientY-z)/R*p.target.offsetHeight;return get_store_value(h.d3Scale),E.setPositionFromMovement(D-E.width/2,q-E.height/2),{...C}})},W=p=>{if(p.preventDefault(),g=!1,u.clickCallback&&y&&u.clickCallback(u),get_store_value(h.options).snap){const C=get_store_value(h.options).snapTo,E=u.positionX,x=u.positionY,z=Math.round(u.positionX/C)*C,F=Math.round(u.positionY/C)*C;d.update(R=>(R[f].setPositionFromMovement(z-E,F-x),{...R}))}};return e.$$set=p=>{"node"in p&&n(0,u=p.node),"canvasId"in p&&n(1,_=p.canvasId),"nodeId"in p&&n(2,f=p.nodeId),"$$scope"in p&&n(17,c=p.$$scope)},n(3,o=!1),[u,_,f,o,s,a,d,S,M,b,I,T,v,k,X,H,W,c,l]}class Node extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$b,create_fragment$b,safe_not_equal,{node:0,canvasId:1,nodeId:2})}}const pkStringGenerator$1=()=>(Math.random()+1).toString(36).substring(7);function createEdgeAndAnchors(e,t,n,o){const r=pkStringGenerator$1(),i=new Edge(r,-1,-1,-1,-1,o,"","bezier","black","black","black",!1,!0,!1,()=>{},""),s=pkStringGenerator$1(),a=dynamicCbCreator(e,r,s),l=new Anchor(s,t,r,"source",-1,-1,a,o,0),c=pkStringGenerator$1(),u=dynamicCbCreator(e,r,c),_=new Anchor(c,n,r,"target",-1,-1,u,o,0),{edgesStore:f,anchorsStore:h}=e;h.update(m=>(m[s]=l,m[c]=_,{...m})),f.update(m=>(m[r]=i,{...m}));const d=getAnchors(e);for(const m of d)m.callback()}const pkStringGenerator=()=>(Math.random()+1).toString(36).substring(7);function createNode(e,t,n,o,r){const i=pkStringGenerator(),s=new Node$1(i,n,o,100,100,"white",{label:"new node"},r,"black",!1,"","black",0,[],"",()=>{}),a=createPotentialAnchor(rightCb,e,i,r),l=createPotentialAnchor(leftCb,e,i,r),c=createPotentialAnchor(topCb,e,i,r),u=createPotentialAnchor(bottomCb,e,i,r),_=pkStringGenerator(),f=new Edge(_,-1,-1,-1,-1,r,"","bezier","black","black","black",!1,!0,!1,()=>{},""),h=pkStringGenerator(),d=dynamicCbCreator(e,_,h),m=new Anchor(h,t,_,"source",-1,-1,d,r,0),N=pkStringGenerator(),S=dynamicCbCreator(e,_,N),B=new Anchor(N,i,_,"target",-1,-1,S,r,0),{nodesStore:M,edgesStore:b,anchorsStore:g,potentialAnchorsStore:y}=e;M.update(v=>(v[i]=s,{...v})),g.update(v=>(v[h]=m,v[N]=B,{...v})),y.update(v=>(v[a.id]=a,v[c.id]=c,v[u.id]=u,v[l.id]=l,{...v})),b.update(v=>(v[_]=f,{...v}));const I=getAnchors(e);for(const v of I)v.callback();const T=getPotentialAnchors(e);for(const v of T)v.callback()}let TemporaryEdge$1=class{constructor(t,n,o,r,i,s,a,l,c,u){this.id=t,this.sourcePotentialAnchorId=n,this.sourceX=o,this.sourceY=r,this.targetPotentialAnchorId=i,this.targetX=s,this.targetY=a,this.canvasId=l,this.type=c,this.edgeColor=u}createEdge(){if(this.targetPotentialAnchorId===null)throw"cannot create edge with null target";const t=findStore(this.canvasId),n=getPotentialAnchorById(t,this.sourcePotentialAnchorId),o=getPotentialAnchorById(t,this.targetPotentialAnchorId),r=getNodeById(t,n.nodeId),i=getNodeById(t,o.nodeId);createEdgeAndAnchors(t,r.id,i.id,this.canvasId)}createNode(){if(this.targetPotentialAnchorId!==null)throw"you should only create a node when you are hovering over blank space";const t=findStore(this.canvasId),o=getPotentialAnchorById(t,this.sourcePotentialAnchorId).nodeId;createNode(t,o,this.targetX,this.targetY,this.canvasId)}};const PotentialAnchor_svelte_svelte_type_style_lang="";function create_fragment$a(e){let t,n,o,r;return{c(){t=element("div"),this.h()},l(i){t=claim_element(i,"DIV",{class:!0,style:!0}),children$1(t).forEach(detach),this.h()},h(){attr(t,"class","Anchor svelte-1amf2u8"),attr(t,"style",n=`
      height:${anchorHeight}px;
      width:${anchorWidth}px;
      top: ${e[2]-anchorHeight/2}px;
      left:${e[1]-anchorWidth/2}px;
    `)},m(i,s){insert_hydration(i,t,s),o||(r=[listen(window,"mousemove",e[12]),listen(window,"mouseup",e[13]),listen(t,"mouseenter",e[14]),listen(t,"mouseleave",e[15]),listen(t,"mousedown",e[16])],o=!0)},p(i,[s]){s&6&&n!==(n=`
      height:${anchorHeight}px;
      width:${anchorWidth}px;
      top: ${i[2]-anchorHeight/2}px;
      left:${i[1]-anchorWidth/2}px;
    `)&&attr(t,"style",n)},i:noop$1,o:noop$1,d(i){i&&detach(t),o=!1,run_all(r)}}}let anchorWidth=8,anchorHeight=8;function instance$a(e,t,n){let o,r,{canvasId:i}=t,{x:s}=t,{y:a}=t,{potentialAnchorId:l}=t;const c=findStore(i),u=getPotentialAnchorById(c,l),{temporaryEdgeStore:_}=findStore(i);let f=!1,h=!1;const d=()=>(Math.random()+1).toString(36).substring(7),m=b=>{b.preventDefault(),f&&_.update(g=>{if(g.length!==1)throw"if you are dragging, there should be one edge. We have not implemented multiple edges";const y=g[0],I=get_store_value(c.d3Scale);return y.targetX+=b.movementX/I,y.targetY+=b.movementY/I,[y]})},N=b=>{n(4,f=!1),get_store_value(_).length===1&&get_store_value(_)[0].targetPotentialAnchorId===l?_.update(g=>{for(let y of g)l===y.targetPotentialAnchorId&&y.createEdge();return[]}):get_store_value(_).length===1&&get_store_value(_)[0].targetPotentialAnchorId===null&&_.update(g=>{for(let y of g)y.createNode();return[]})},S=b=>{n(5,h=!0),_.update(g=>{for(let y of g)y.targetPotentialAnchorId=l;return[...g]})},B=b=>{n(5,h=!1),f&&_.update(g=>{for(let y of g)y.targetPotentialAnchorId===l&&(y.targetPotentialAnchorId=null);return[...g]})},M=b=>{b.preventDefault(),b.stopPropagation(),n(4,f=!0),_.update(g=>{if(g.length===0)return[new TemporaryEdge$1(d(),u.id,o,r,null,o,r,i,"straight","black")];throw"there should only be zero or one temporary edge at any given time"})};return e.$$set=b=>{"canvasId"in b&&n(0,i=b.canvasId),"x"in b&&n(1,s=b.x),"y"in b&&n(2,a=b.y),"potentialAnchorId"in b&&n(3,l=b.potentialAnchorId)},e.$$.update=()=>{e.$$.dirty&2&&n(7,o=s),e.$$.dirty&4&&n(6,r=a)},[i,s,a,l,f,h,r,o,c,u,_,d,m,N,S,B,M]}class PotentialAnchor extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$a,create_fragment$a,safe_not_equal,{canvasId:0,x:1,y:2,potentialAnchorId:3})}}const TemporaryEdge_svelte_svelte_type_style_lang="";function create_fragment$9(e){let t;return{c(){t=svg_element("path"),this.h()},l(n){t=claim_svg_element(n,"path",{class:!0,d:!0,fill:!0,stroke:!0,"marker-end":!0,"aria-label":!0}),children$1(t).forEach(detach),this.h()},h(){attr(t,"class","animate svelte-qtkn5z"),attr(t,"d",e[0]),attr(t,"fill","transparent"),attr(t,"stroke","gray"),attr(t,"marker-end","url(#arrow)"),attr(t,"aria-label","svg-path")},m(n,o){insert_hydration(n,t,o)},p(n,[o]){o&1&&attr(t,"d",n[0])},i:noop$1,o:noop$1,d(n){n&&detach(t)}}}function instance$9(e,t,n){let{temporaryEdge:o}=t,r="";return e.$$set=i=>{"temporaryEdge"in i&&n(1,o=i.temporaryEdge)},e.$$.update=()=>{e.$$.dirty&2&&n(0,r=`M ${o.sourceX},${o.sourceY}L ${o.targetX},${o.targetY}`)},[r,o]}class TemporaryEdge extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$9,create_fragment$9,safe_not_equal,{temporaryEdge:1})}}function zoomInit(e,t,n,o,r,i,s){return e.select(`.Edges-${t}`).transition().duration(0).call(n.translateTo,0,0).transition().duration(0).call(n.translateTo,r.x/i,r.y/i).transition().duration(0).call(n.scaleTo,i.toFixed(2)),o=e.zoomIdentity.translate(r.x,r.y).scale(i.toFixed(2)),e.select(`.Nodes-${t}`).transition().duration(0).call(n.translateTo,0,0).transition().duration(0).call(n.translateTo,r.x/i,r.y/i).transition().duration(0).call(n.scaleTo,i.toFixed(2)),s.set(e.zoomTransform(e.select(`.Nodes-${t}`)).k),o}function determineD3Instance(e,t,n,o,r,i,s,a,l,c,u,_){return e?t.zoom().filter(()=>!get_store_value(n)).scaleExtent([.4,2]).translateExtent([[0,0],[e.x,e.y]]).extent([[0,0],[o,r]]).on("zoom",_):t.zoom().filter(()=>!get_store_value(n)).scaleExtent([.4,2]).on("zoom",_)}const GreyNodeBoundary_svelte_svelte_type_style_lang="";function create_fragment$8(e){let t,n;return{c(){t=element("div"),this.h()},l(o){t=claim_element(o,"DIV",{class:!0,style:!0}),children$1(t).forEach(detach),this.h()},h(){attr(t,"class",n="nodes nodes-"+e[0]+" svelte-1eef8gz"),set_style(t,"top",e[1]+"px"),set_style(t,"left",e[2]+"px"),set_style(t,"height",e[4]+"px"),set_style(t,"width",e[3]+"px")},m(o,r){insert_hydration(o,t,r)},p(o,[r]){r&1&&n!==(n="nodes nodes-"+o[0]+" svelte-1eef8gz")&&attr(t,"class",n),r&2&&set_style(t,"top",o[1]+"px"),r&4&&set_style(t,"left",o[2]+"px"),r&16&&set_style(t,"height",o[4]+"px"),r&8&&set_style(t,"width",o[3]+"px")},i:noop$1,o:noop$1,d(o){o&&detach(t)}}}function instance$8(e,t,n){let{key:o}=t,{node:r}=t,{heightRatio:i}=t,{widthRatio:s}=t,a=0,l=0,c=0,u=0;return e.$$set=_=>{"key"in _&&n(0,o=_.key),"node"in _&&n(5,r=_.node),"heightRatio"in _&&n(6,i=_.heightRatio),"widthRatio"in _&&n(7,s=_.widthRatio)},e.$$.update=()=>{e.$$.dirty&224&&(n(4,u=Math.max(r.height*i,5)),n(3,c=Math.max(r.width*s,5)),n(1,a=r.positionY*i),n(2,l=r.positionX*s))},[o,a,l,c,u,r,i,s]}class GreyNodeBoundary extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$8,create_fragment$8,safe_not_equal,{key:0,node:5,heightRatio:6,widthRatio:7})}}const MinimapBoundary_svelte_svelte_type_style_lang="";function get_each_context$2(e,t,n){const o=e.slice();return o[21]=t[n],o}function create_each_block$2(e){let t,n;return t=new GreyNodeBoundary({props:{node:e[21],key:e[0],heightRatio:e[5],widthRatio:e[4]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r&2048&&(i.node=o[21]),r&1&&(i.key=o[0]),r&32&&(i.heightRatio=o[5]),r&16&&(i.widthRatio=o[4]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_fragment$7(e){let t,n,o,r,i,s,a,l,c=Object.values(e[11]),u=[];for(let f=0;f<c.length;f+=1)u[f]=create_each_block$2(get_each_context$2(e,c,f));const _=f=>transition_out(u[f],1,1,()=>{u[f]=null});return{c(){t=element("div"),n=element("div"),r=space();for(let f=0;f<u.length;f+=1)u[f].c();this.h()},l(f){t=claim_element(f,"DIV",{class:!0,style:!0});var h=children$1(t);n=claim_element(h,"DIV",{class:!0,style:!0}),children$1(n).forEach(detach),r=claim_space(h);for(let d=0;d<u.length;d+=1)u[d].l(h);h.forEach(detach),this.h()},h(){attr(n,"class",o="viewBox viewBox-"+e[0]+" svelte-ds0tpb"),set_style(n,"height",e[9]*e[5]/e[1].k+"px"),set_style(n,"width",e[10]*e[4]/e[1].k+"px"),set_style(n,"top",e[7]+"px"),set_style(n,"left",e[6]+"px"),attr(t,"class",i=null_to_empty(`miniMap miniMap-${e[0]}`)+" svelte-ds0tpb"),set_style(t,"height",e[2]+2+"px"),set_style(t,"width",e[3]+2+"px")},m(f,h){insert_hydration(f,t,h),append_hydration(t,n),append_hydration(t,r);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(t,null);e[18](t),s=!0,a||(l=[listen(t,"click",e[15]),listen(t,"keydown",keydown_handler$1)],a=!0)},p(f,[h]){if((!s||h&1&&o!==(o="viewBox viewBox-"+f[0]+" svelte-ds0tpb"))&&attr(n,"class",o),(!s||h&546)&&set_style(n,"height",f[9]*f[5]/f[1].k+"px"),(!s||h&1042)&&set_style(n,"width",f[10]*f[4]/f[1].k+"px"),(!s||h&128)&&set_style(n,"top",f[7]+"px"),(!s||h&64)&&set_style(n,"left",f[6]+"px"),h&2097){c=Object.values(f[11]);let d;for(d=0;d<c.length;d+=1){const m=get_each_context$2(f,c,d);u[d]?(u[d].p(m,h),transition_in(u[d],1)):(u[d]=create_each_block$2(m),u[d].c(),transition_in(u[d],1),u[d].m(t,null))}for(group_outros(),d=c.length;d<u.length;d+=1)_(d);check_outros()}(!s||h&1&&i!==(i=null_to_empty(`miniMap miniMap-${f[0]}`)+" svelte-ds0tpb"))&&attr(t,"class",i),(!s||h&4)&&set_style(t,"height",f[2]+2+"px"),(!s||h&8)&&set_style(t,"width",f[3]+2+"px")},i(f){if(!s){for(let h=0;h<c.length;h+=1)transition_in(u[h]);s=!0}},o(f){u=u.filter(Boolean);for(let h=0;h<u.length;h+=1)transition_out(u[h]);s=!1},d(f){f&&detach(t),destroy_each(u,f),e[18](null),a=!1,run_all(l)}}}const keydown_handler$1=()=>{};function instance$7(e,t,n){let o,r,i,{key:s}=t,{boundary:a}=t,{d3Translate:l}=t,{store:c}=t;const{nodesStore:u,heightStore:_,widthStore:f}=c;component_subscribe(e,u,T=>n(11,i=T)),component_subscribe(e,_,T=>n(9,o=T)),component_subscribe(e,f,T=>n(10,r=T));const h=createEventDispatcher();let d=100,m=100,N=1,S=1,B=1,M=1,b,g=!1;function y(T){if(!g){g=!0;let v=b.getBoundingClientRect();h("message",{x:(T.clientX-v.left)/N,y:(T.clientY-v.top)/S}),setTimeout(()=>{g=!1},500)}}function I(T){binding_callbacks[T?"unshift":"push"](()=>{b=T,n(8,b)})}return e.$$set=T=>{"key"in T&&n(0,s=T.key),"boundary"in T&&n(16,a=T.boundary),"d3Translate"in T&&n(1,l=T.d3Translate),"store"in T&&n(17,c=T.store)},e.$$.update=()=>{e.$$.dirty&65598&&(a.y>a.x?(n(2,d=100),n(3,m=Math.max(a.x.toFixed(0)*100/a.y.toFixed(0),25))):a.y<a.x?(n(3,m=100),n(2,d=Math.max(a.y.toFixed(0)*100/a.x.toFixed(0),25))):(n(2,d=100),n(3,m=100)),n(4,N=m/a.x),n(5,S=d/a.y),n(6,B=Math.abs(l.x*N/l.k)),n(7,M=Math.abs(l.y*S/l.k)))},[s,l,d,m,N,S,B,M,b,o,r,i,u,_,f,y,a,c,I]}class MinimapBoundary extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$7,create_fragment$7,safe_not_equal,{key:0,boundary:16,d3Translate:1,store:17})}}const GreyNodeBoundless_svelte_svelte_type_style_lang="";function create_fragment$6(e){let t,n;return{c(){t=element("div"),this.h()},l(o){t=claim_element(o,"DIV",{class:!0,style:!0}),children$1(t).forEach(detach),this.h()},h(){attr(t,"class",n="nodes nodes-"+e[0]+" svelte-1eef8gz"),set_style(t,"top",e[1]+"px"),set_style(t,"left",e[2]+"px"),set_style(t,"height",e[4]+"px"),set_style(t,"width",e[3]+"px")},m(o,r){insert_hydration(o,t,r)},p(o,[r]){r&1&&n!==(n="nodes nodes-"+o[0]+" svelte-1eef8gz")&&attr(t,"class",n),r&2&&set_style(t,"top",o[1]+"px"),r&4&&set_style(t,"left",o[2]+"px"),r&16&&set_style(t,"height",o[4]+"px"),r&8&&set_style(t,"width",o[3]+"px")},i:noop$1,o:noop$1,d(o){o&&detach(t)}}}function instance$6(e,t,n){let{key:o}=t,{node:r}=t,{heightRatio:i}=t,{widthRatio:s}=t,{nodeXleftPosition:a}=t,{nodeYbottomPosition:l}=t,c=0,u=0,_=0,f=0;return e.$$set=h=>{"key"in h&&n(0,o=h.key),"node"in h&&n(5,r=h.node),"heightRatio"in h&&n(6,i=h.heightRatio),"widthRatio"in h&&n(7,s=h.widthRatio),"nodeXleftPosition"in h&&n(8,a=h.nodeXleftPosition),"nodeYbottomPosition"in h&&n(9,l=h.nodeYbottomPosition)},e.$$.update=()=>{e.$$.dirty&992&&(n(4,f=Math.max(r.height*i,5)),n(3,_=Math.max(r.width*s,5)),n(1,c=r.positionY*i-l*i+1),n(2,u=r.positionX*s-a*s+1))},[o,c,u,_,f,r,i,s,a,l]}class GreyNodeBoundless extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$6,create_fragment$6,safe_not_equal,{key:0,node:5,heightRatio:6,widthRatio:7,nodeXleftPosition:8,nodeYbottomPosition:9})}}const MinimapBoundless_svelte_svelte_type_style_lang="";function get_each_context$1(e,t,n){const o=e.slice();return o[30]=t[n],o}function create_each_block$1(e){let t,n;return t=new GreyNodeBoundless({props:{node:e[30],key:e[0],heightRatio:e[3],widthRatio:e[4],nodeXleftPosition:e[5],nodeYbottomPosition:e[6]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r[0]&128&&(i.node=o[30]),r[0]&1&&(i.key=o[0]),r[0]&8&&(i.heightRatio=o[3]),r[0]&16&&(i.widthRatio=o[4]),r[0]&32&&(i.nodeXleftPosition=o[5]),r[0]&64&&(i.nodeYbottomPosition=o[6]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_fragment$5(e){let t,n,o,r,i,s,a,l,c=Object.values(e[7]),u=[];for(let f=0;f<c.length;f+=1)u[f]=create_each_block$1(get_each_context$1(e,c,f));const _=f=>transition_out(u[f],1,1,()=>{u[f]=null});return{c(){t=element("div"),n=element("div"),r=space();for(let f=0;f<u.length;f+=1)u[f].c();this.h()},l(f){t=claim_element(f,"DIV",{class:!0,style:!0});var h=children$1(t);n=claim_element(h,"DIV",{class:!0,style:!0}),children$1(n).forEach(detach),r=claim_space(h);for(let d=0;d<u.length;d+=1)u[d].l(h);h.forEach(detach),this.h()},h(){attr(n,"class",o="viewBox viewBox-"+e[0]+" svelte-ds0tpb"),set_style(n,"height",e[8]+"px"),set_style(n,"width",e[9]+"px"),set_style(n,"top",e[11]+"px"),set_style(n,"left",e[10]+"px"),attr(t,"class",i=null_to_empty(`miniMap miniMap-${e[0]}`)+" svelte-ds0tpb"),set_style(t,"height",e[2]+20+"px"),set_style(t,"width",e[1]+20+"px")},m(f,h){insert_hydration(f,t,h),append_hydration(t,n),append_hydration(t,r);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(t,null);e[25](t),s=!0,a||(l=[listen(t,"click",e[16]),listen(t,"keydown",keydown_handler)],a=!0)},p(f,h){if((!s||h[0]&1&&o!==(o="viewBox viewBox-"+f[0]+" svelte-ds0tpb"))&&attr(n,"class",o),(!s||h[0]&256)&&set_style(n,"height",f[8]+"px"),(!s||h[0]&512)&&set_style(n,"width",f[9]+"px"),(!s||h[0]&2048)&&set_style(n,"top",f[11]+"px"),(!s||h[0]&1024)&&set_style(n,"left",f[10]+"px"),h[0]&249){c=Object.values(f[7]);let d;for(d=0;d<c.length;d+=1){const m=get_each_context$1(f,c,d);u[d]?(u[d].p(m,h),transition_in(u[d],1)):(u[d]=create_each_block$1(m),u[d].c(),transition_in(u[d],1),u[d].m(t,null))}for(group_outros(),d=c.length;d<u.length;d+=1)_(d);check_outros()}(!s||h[0]&1&&i!==(i=null_to_empty(`miniMap miniMap-${f[0]}`)+" svelte-ds0tpb"))&&attr(t,"class",i),(!s||h[0]&4)&&set_style(t,"height",f[2]+20+"px"),(!s||h[0]&2)&&set_style(t,"width",f[1]+20+"px")},i(f){if(!s){for(let h=0;h<c.length;h+=1)transition_in(u[h]);s=!0}},o(f){u=u.filter(Boolean);for(let h=0;h<u.length;h+=1)transition_out(u[h]);s=!1},d(f){f&&detach(t),destroy_each(u,f),e[25](null),a=!1,run_all(l)}}}let mapMax=100;const keydown_handler=()=>{};function instance$5(e,t,n){let o,r,i,{key:s}=t,{d3Translate:a}=t,{store:l}=t;const{nodesStore:c,widthStore:u,heightStore:_}=l;component_subscribe(e,c,x=>n(7,i=x)),component_subscribe(e,u,x=>n(24,r=x)),component_subscribe(e,_,x=>n(23,o=x));const f=createEventDispatcher();let h=mapMax,d=mapMax,m=mapMax-10,N=mapMax-10,S=10,B=10,M=10,b=10,g=1,y=1,I=1/0,T=-1/0,v=1/0,k=-1/0,X,H=!1;const W=x=>x*(h/N),p=x=>x*(d/m);function C(x){if(!H){let z=X.getBoundingClientRect();H=!0,f("message",{x:I+(x.clientX-z.left)/y,y:v+(x.clientY-z.top)/g}),setTimeout(()=>{H=!1},500)}}function E(x){binding_callbacks[x?"unshift":"push"](()=>{X=x,n(12,X)})}return e.$$set=x=>{"key"in x&&n(0,s=x.key),"d3Translate"in x&&n(17,a=x.d3Translate),"store"in x&&n(18,l=x.store)},e.$$.update=()=>{e.$$.dirty[0]&33161470&&(n(5,I=1/0),n(21,T=-1/0),n(6,v=1/0),n(22,k=-1/0),Object.values(i).forEach(x=>{n(5,I=Math.min(I,x.positionX)),n(22,k=Math.max(k,x.positionX)),n(6,v=Math.min(v,x.positionY)),n(21,T=Math.max(T,x.positionY))}),n(19,m=T-v),n(20,N=k-I),m>N?(n(2,d=100),n(1,h=Math.max(N.toFixed(0)*100/m.toFixed(0),25))):m<N?(n(1,h=100),n(2,d=Math.max(m.toFixed(0)*100/N.toFixed(0),25))):(n(2,d=100),n(1,h=100)),n(3,g=(d/m).toFixed(2)),n(4,y=(h/N).toFixed(2)),n(10,M=W(a.x*y-a.x/a.k)-I*y),n(11,b=p(a.y*g-a.y/a.k)-v*g),n(9,B=r*y/a.k),n(8,S=o*g/a.k))},[s,h,d,g,y,I,v,i,S,B,M,b,X,c,u,_,C,a,l,m,N,T,k,o,r,E]}class MinimapBoundless extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$5,create_fragment$5,safe_not_equal,{key:0,d3Translate:17,store:18},null,[-1,-1])}}const EditEdge_svelte_svelte_type_style_lang="";function create_fragment$4(e){let t,n,o,r,i,s,a,l,c,u,_,f,h,d,m,N,S,B,M,b,g,y,I,T,v,k,X,H,W,p,C,E,x;return{c(){t=element("div"),n=element("form"),o=element("label"),r=text("Edge label"),i=space(),s=element("input"),l=space(),c=element("label"),u=text("Edge color"),_=space(),f=element("input"),d=space(),m=element("input"),N=space(),S=element("label"),B=text("Edge type"),M=space(),b=element("input"),y=space(),I=element("div"),T=element("button"),v=text("Submit"),k=space(),X=element("button"),H=text("Delete"),W=space(),p=element("button"),C=text("Cancel"),this.h()},l(z){t=claim_element(z,"DIV",{class:!0,style:!0});var F=children$1(t);n=claim_element(F,"FORM",{class:!0});var R=children$1(n);o=claim_element(R,"LABEL",{for:!0,class:!0});var D=children$1(o);r=claim_text(D,"Edge label"),D.forEach(detach),i=claim_space(R),s=claim_element(R,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0}),l=claim_space(R),c=claim_element(R,"LABEL",{for:!0,class:!0});var q=children$1(c);u=claim_text(q,"Edge color"),q.forEach(detach),_=claim_space(R),f=claim_element(R,"INPUT",{type:!0,id:!0,class:!0}),d=claim_space(R),m=claim_element(R,"INPUT",{type:!0,placeholder:!0,class:!0}),N=claim_space(R),S=claim_element(R,"LABEL",{for:!0,class:!0});var V=children$1(S);B=claim_text(V,"Edge type"),V.forEach(detach),M=claim_space(R),b=claim_element(R,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0}),R.forEach(detach),y=claim_space(F),I=claim_element(F,"DIV",{class:!0});var Y=children$1(I);T=claim_element(Y,"BUTTON",{class:!0});var L=children$1(T);v=claim_text(L,"Submit"),L.forEach(detach),k=claim_space(Y),X=claim_element(Y,"BUTTON",{class:!0});var j=children$1(X);H=claim_text(j,"Delete"),j.forEach(detach),W=claim_space(Y),p=claim_element(Y,"BUTTON",{class:!0});var Q=children$1(p);C=claim_text(Q,"Cancel"),Q.forEach(detach),Y.forEach(detach),F.forEach(detach),this.h()},h(){attr(o,"for","label-input"),attr(o,"class","svelte-1bj3i1h"),attr(s,"type","text"),attr(s,"id",a="label-input-"+e[0]),attr(s,"placeholder",e[7].label),attr(s,"class","svelte-1bj3i1h"),attr(c,"for","bg-color-input"),attr(c,"class","svelte-1bj3i1h"),attr(f,"type","color"),attr(f,"id",h="bg-color-input-"+e[0]),attr(f,"class","bgci svelte-1bj3i1h"),attr(m,"type","text"),attr(m,"placeholder",e[7].edgeColor),attr(m,"class","svelte-1bj3i1h"),attr(S,"for","type-input"),attr(S,"class","svelte-1bj3i1h"),attr(b,"type","text"),attr(b,"id",g="type-input-"+e[0]),attr(b,"placeholder",e[7].type),attr(b,"class","svelte-1bj3i1h"),attr(n,"class","svelte-1bj3i1h"),attr(T,"class","svelte-1bj3i1h"),attr(X,"class","svelte-1bj3i1h"),attr(p,"class","svelte-1bj3i1h"),attr(I,"class","btn-container svelte-1bj3i1h"),attr(t,"class","EditEdge svelte-1bj3i1h"),set_style(t,"left",e[5]/3+"px"),set_style(t,"top",e[6]/3+"px")},m(z,F){insert_hydration(z,t,F),append_hydration(t,n),append_hydration(n,o),append_hydration(o,r),append_hydration(n,i),append_hydration(n,s),set_input_value(s,e[1]),append_hydration(n,l),append_hydration(n,c),append_hydration(c,u),append_hydration(n,_),append_hydration(n,f),set_input_value(f,e[2]),append_hydration(n,d),append_hydration(n,m),set_input_value(m,e[2]),append_hydration(n,N),append_hydration(n,S),append_hydration(S,B),append_hydration(n,M),append_hydration(n,b),set_input_value(b,e[3]),append_hydration(t,y),append_hydration(t,I),append_hydration(I,T),append_hydration(T,v),append_hydration(I,k),append_hydration(I,X),append_hydration(X,H),append_hydration(I,W),append_hydration(I,p),append_hydration(p,C),E||(x=[listen(s,"input",e[16]),listen(f,"input",e[17]),listen(m,"input",e[18]),listen(b,"input",e[19]),listen(n,"submit",e[12]),listen(T,"click",e[12]),listen(X,"click",e[11]),listen(p,"click",e[10]),listen(t,"mouseover",e[20]),listen(t,"focus",e[14]),listen(t,"wheel",prevent_default(e[15]))],E=!0)},p(z,[F]){F&1&&a!==(a="label-input-"+z[0])&&attr(s,"id",a),F&2&&s.value!==z[1]&&set_input_value(s,z[1]),F&1&&h!==(h="bg-color-input-"+z[0])&&attr(f,"id",h),F&4&&set_input_value(f,z[2]),F&4&&m.value!==z[2]&&set_input_value(m,z[2]),F&1&&g!==(g="type-input-"+z[0])&&attr(b,"id",g),F&8&&b.value!==z[3]&&set_input_value(b,z[3])},i:noop$1,o:noop$1,d(z){z&&detach(t),E=!1,run_all(x)}}}function instance$4(e,t,n){let o,r,{edgeId:i}=t,{canvasId:s}=t,a,l,c;const u=findStore(s),_=get_store_value(u.widthStore),f=get_store_value(u.widthStore),h=getEdgeById(u,i),{edgesStore:d,nodeSelected:m}=u;component_subscribe(e,d,k=>n(21,o=k)),component_subscribe(e,m,k=>n(4,r=k));function N(){findStore(s).edgeEditModal.set(null)}function S(){const k=findStore(s);getEdgeById(k,i).delete(),N()}function B(k){k.preventDefault();const X=findStore(s),H=getEdgeById(X,i);a&&(H.label=a),l&&(H.edgeColor=l),c&&(H.type=c),X.edgesStore.set(o),N()}function M(k){bubble.call(this,e,k)}function b(k){bubble.call(this,e,k)}function g(){a=this.value,n(1,a)}function y(){l=this.value,n(2,l)}function I(){l=this.value,n(2,l)}function T(){c=this.value,n(3,c)}const v=k=>set_store_value(m,r=!0,r);return e.$$set=k=>{"edgeId"in k&&n(0,i=k.edgeId),"canvasId"in k&&n(13,s=k.canvasId)},[i,a,l,c,r,_,f,h,d,m,N,S,B,s,M,b,g,y,I,T,v]}class EditEdge extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$4,create_fragment$4,safe_not_equal,{edgeId:0,canvasId:13})}}const GraphView_svelte_svelte_type_style_lang="";function get_each_context(e,t,n){const o=e.slice();return o[55]=t[n],o}function get_each_context_1(e,t,n){const o=e.slice();return o[58]=t[n],o}function get_each_context_2(e,t,n){const o=e.slice();return o[61]=t[n],o}function get_each_context_3(e,t,n){const o=e.slice();return o[64]=t[n],o}function get_each_context_4(e,t,n){const o=e.slice();return o[67]=t[n],o}function get_each_context_5(e,t,n){const o=e.slice();return o[70]=t[n],o}function create_if_block_8(e){let t,n;return t=new EditEdge({props:{edgeId:`${e[10]}`,canvasId:e[0]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r[0]&1024&&(i.edgeId=`${o[10]}`),r[0]&1&&(i.canvasId=o[0]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_if_block_7(e){let t,n,o;return n=new MinimapBoundless({props:{key:e[28],d3Translate:e[3],store:e[14]}}),n.$on("message",e[27]),{c(){t=element("div"),create_component(n.$$.fragment),this.h()},l(r){t=claim_element(r,"DIV",{class:!0});var i=children$1(t);claim_component(n.$$.fragment,i),i.forEach(detach),this.h()},h(){attr(t,"class","pointer-events-auto svelte-76zvyt")},m(r,i){insert_hydration(r,t,i),mount_component(n,t,null),o=!0},p(r,i){const s={};i[0]&8&&(s.d3Translate=r[3]),n.$set(s)},i(r){o||(transition_in(n.$$.fragment,r),o=!0)},o(r){transition_out(n.$$.fragment,r),o=!1},d(r){r&&detach(t),destroy_component(n)}}}function create_if_block_6(e){let t,n,o;return n=new MinimapBoundary({props:{key:e[28],boundary:e[1],d3Translate:e[3],store:e[14]}}),n.$on("message",e[27]),{c(){t=element("div"),create_component(n.$$.fragment),this.h()},l(r){t=claim_element(r,"DIV",{class:!0});var i=children$1(t);claim_component(n.$$.fragment,i),i.forEach(detach),this.h()},h(){attr(t,"class","pointer-events-auto svelte-76zvyt")},m(r,i){insert_hydration(r,t,i),mount_component(n,t,null),o=!0},p(r,i){const s={};i[0]&2&&(s.boundary=r[1]),i[0]&8&&(s.d3Translate=r[3]),n.$set(s)},i(r){o||(transition_in(n.$$.fragment,r),o=!0)},o(r){transition_out(n.$$.fragment,r),o=!1},d(r){r&&detach(t),destroy_component(n)}}}function create_else_block_1(e){let t,n;return t=new Node({props:{node:e[70],canvasId:e[0],nodeId:e[70].id,$$slots:{default:[create_default_slot_2]},$$scope:{ctx:e}}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r[0]&16&&(i.node=o[70]),r[0]&1&&(i.canvasId=o[0]),r[0]&16&&(i.nodeId=o[70].id),r[0]&16|r[2]&2048&&(i.$$scope={dirty:r,ctx:o}),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_if_block_5(e){let t,n;return t=new Node({props:{node:e[70],canvasId:e[0],nodeId:e[70].id,$$slots:{default:[create_default_slot_1]},$$scope:{ctx:e}}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r[0]&16&&(i.node=o[70]),r[0]&1&&(i.canvasId=o[0]),r[0]&16&&(i.nodeId=o[70].id),r[0]&16|r[2]&2048&&(i.$$scope={dirty:r,ctx:o}),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_if_block_4(e){let t,n;return t=new Node({props:{node:e[70],canvasId:e[0],nodeId:e[70].id,$$slots:{default:[create_default_slot]},$$scope:{ctx:e}}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r[0]&16&&(i.node=o[70]),r[0]&1&&(i.canvasId=o[0]),r[0]&16&&(i.nodeId=o[70].id),r[0]&16|r[2]&2048&&(i.$$scope={dirty:r,ctx:o}),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_default_slot_2(e){let t=e[70].data.label+"",n;return{c(){n=text(t)},l(o){n=claim_text(o,t)},m(o,r){insert_hydration(o,n,r)},p(o,r){r[0]&16&&t!==(t=o[70].data.label+"")&&set_data(n,t)},d(o){o&&detach(n)}}}function create_default_slot_1(e){let t,n,o;var r=e[70].data.custom;function i(s){return{}}return r&&(t=construct_svelte_component(r,i())),{c(){t&&create_component(t.$$.fragment),n=empty$1()},l(s){t&&claim_component(t.$$.fragment,s),n=empty$1()},m(s,a){t&&mount_component(t,s,a),insert_hydration(s,n,a),o=!0},p(s,a){if(a[0]&16&&r!==(r=s[70].data.custom)){if(t){group_outros();const l=t;transition_out(l.$$.fragment,1,0,()=>{destroy_component(l,1)}),check_outros()}r?(t=construct_svelte_component(r,i()),create_component(t.$$.fragment),transition_in(t.$$.fragment,1),mount_component(t,n.parentNode,n)):t=null}},i(s){o||(t&&transition_in(t.$$.fragment,s),o=!0)},o(s){t&&transition_out(t.$$.fragment,s),o=!1},d(s){s&&detach(n),t&&destroy_component(t,s)}}}function create_default_slot(e){let t,n=e[70].data.html+"",o;return{c(){t=new HtmlTagHydration(!1),o=empty$1(),this.h()},l(r){t=claim_html_tag(r,!1),o=empty$1(),this.h()},h(){t.a=o},m(r,i){t.m(n,r,i),insert_hydration(r,o,i)},p(r,i){i[0]&16&&n!==(n=r[70].data.html+"")&&t.p(n)},d(r){r&&detach(o),r&&t.d()}}}function create_each_block_5(e){let t,n,o,r;const i=[create_if_block_4,create_if_block_5,create_else_block_1],s=[];function a(l,c){return l[70].data.html?0:l[70].data.custom?1:2}return t=a(e),n=s[t]=i[t](e),{c(){n.c(),o=empty$1()},l(l){n.l(l),o=empty$1()},m(l,c){s[t].m(l,c),insert_hydration(l,o,c),r=!0},p(l,c){let u=t;t=a(l),t===u?s[t].p(l,c):(group_outros(),transition_out(s[u],1,1,()=>{s[u]=null}),check_outros(),n=s[t],n?n.p(l,c):(n=s[t]=i[t](l),n.c()),transition_in(n,1),n.m(o.parentNode,o))},i(l){r||(transition_in(n),r=!0)},o(l){transition_out(n),r=!1},d(l){s[t].d(l),l&&detach(o)}}}function create_each_block_4(e){let t,n;return t=new ResizeNode({props:{resizeId:e[67].id,canvasId:e[0]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r[0]&64&&(i.resizeId=o[67].id),r[0]&1&&(i.canvasId=o[0]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_each_block_3(e){let t,n;return t=new PotentialAnchor({props:{canvasId:e[0],x:e[64].positionX,y:e[64].positionY,potentialAnchorId:e[64].id}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r[0]&1&&(i.canvasId=o[0]),r[0]&512&&(i.x=o[64].positionX),r[0]&512&&(i.y=o[64].positionY),r[0]&512&&(i.potentialAnchorId=o[64].id),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_if_block_3(e){let t;return{c(){t=svg_element("rect"),this.h()},l(n){t=claim_svg_element(n,"rect",{width:!0,height:!0,style:!0}),children$1(t).forEach(detach),this.h()},h(){attr(t,"width","100%"),attr(t,"height","100%"),set_style(t,"fill","url(#background-"+e[0]+")")},m(n,o){insert_hydration(n,t,o)},p(n,o){o[0]&1&&set_style(t,"fill","url(#background-"+n[0]+")")},d(n){n&&detach(t)}}}function create_else_block(e){let t,n;return t=new SimpleBezierEdge({props:{edgeId:e[61].id,canvasId:e[0]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r[0]&32&&(i.edgeId=o[61].id),r[0]&1&&(i.canvasId=o[0]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_if_block_2(e){let t,n;return t=new StepEdge({props:{edge:e[61],canvasId:e[0]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r[0]&32&&(i.edge=o[61]),r[0]&1&&(i.canvasId=o[0]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_if_block_1(e){let t,n;return t=new SmoothStepEdge({props:{edge:e[61],canvasId:e[0]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r[0]&32&&(i.edge=o[61]),r[0]&1&&(i.canvasId=o[0]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_if_block$1(e){let t,n;return t=new StraightEdge({props:{edgeId:e[61].id,canvasId:e[0]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r[0]&32&&(i.edgeId=o[61].id),r[0]&1&&(i.canvasId=o[0]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_each_block_2(e){let t,n,o,r;const i=[create_if_block$1,create_if_block_1,create_if_block_2,create_else_block],s=[];function a(l,c){return l[61].type==="straight"?0:l[61].type==="smoothstep"?1:l[61].type==="step"?2:3}return t=a(e),n=s[t]=i[t](e),{c(){n.c(),o=empty$1()},l(l){n.l(l),o=empty$1()},m(l,c){s[t].m(l,c),insert_hydration(l,o,c),r=!0},p(l,c){let u=t;t=a(l),t===u?s[t].p(l,c):(group_outros(),transition_out(s[u],1,1,()=>{s[u]=null}),check_outros(),n=s[t],n?n.p(l,c):(n=s[t]=i[t](l),n.c()),transition_in(n,1),n.m(o.parentNode,o))},i(l){r||(transition_in(n),r=!0)},o(l){transition_out(n),r=!1},d(l){s[t].d(l),l&&detach(o)}}}function create_each_block_1(e){let t,n;return t=new TemporaryEdge({props:{temporaryEdge:e[58]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r[0]&256&&(i.temporaryEdge=o[58]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_each_block(e){let t,n;return t=new EdgeAnchor({props:{x:e[55].positionX,y:e[55].positionY}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r[0]&128&&(i.x=o[55].positionX),r[0]&128&&(i.y=o[55].positionY),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_fragment$3(e){let t,n,o,r,i,s,a,l,c,u,_,f,h,d,m,N,S,B,M,b,g,y,I,T,v,k=e[10]&&create_if_block_8(e);const X=[create_if_block_6,create_if_block_7],H=[];function W(w,P){return w[2]&&w[1]?0:w[2]?1:-1}~(o=W(e))&&(r=H[o]=X[o](e));let p=e[4],C=[];for(let w=0;w<p.length;w+=1)C[w]=create_each_block_5(get_each_context_5(e,p,w));const E=w=>transition_out(C[w],1,1,()=>{C[w]=null});let x=e[6],z=[];for(let w=0;w<x.length;w+=1)z[w]=create_each_block_4(get_each_context_4(e,x,w));const F=w=>transition_out(z[w],1,1,()=>{z[w]=null});let R=e[9],D=[];for(let w=0;w<R.length;w+=1)D[w]=create_each_block_3(get_each_context_3(e,R,w));const q=w=>transition_out(D[w],1,1,()=>{D[w]=null});let V=e[13]&&create_if_block_3(e),Y=e[5],L=[];for(let w=0;w<Y.length;w+=1)L[w]=create_each_block_2(get_each_context_2(e,Y,w));const j=w=>transition_out(L[w],1,1,()=>{L[w]=null});let Q=e[8],K=[];for(let w=0;w<Q.length;w+=1)K[w]=create_each_block_1(get_each_context_1(e,Q,w));const te=w=>transition_out(K[w],1,1,()=>{K[w]=null});let ee=e[7],U=[];for(let w=0;w<ee.length;w+=1)U[w]=create_each_block(get_each_context(e,ee,w));const $=w=>transition_out(U[w],1,1,()=>{U[w]=null});return{c(){k&&k.c(),t=space(),n=element("div"),r&&r.c(),i=space(),s=element("div"),a=element("div");for(let w=0;w<C.length;w+=1)C[w].c();l=space();for(let w=0;w<z.length;w+=1)z[w].c();c=space();for(let w=0;w<D.length;w+=1)D[w].c();f=space(),h=svg_element("svg"),d=svg_element("defs"),m=svg_element("pattern"),N=svg_element("circle"),V&&V.c(),B=svg_element("g");for(let w=0;w<L.length;w+=1)L[w].c();M=empty$1();for(let w=0;w<K.length;w+=1)K[w].c();b=empty$1();for(let w=0;w<U.length;w+=1)U[w].c();this.h()},l(w){k&&k.l(w),t=claim_space(w),n=claim_element(w,"DIV",{id:!0,class:!0});var P=children$1(n);r&&r.l(P),i=claim_space(P),s=claim_element(P,"DIV",{class:!0});var G=children$1(s);a=claim_element(G,"DIV",{class:!0});var A=children$1(a);for(let Z=0;Z<C.length;Z+=1)C[Z].l(A);l=claim_space(A);for(let Z=0;Z<z.length;Z+=1)z[Z].l(A);c=claim_space(A);for(let Z=0;Z<D.length;Z+=1)D[Z].l(A);A.forEach(detach),G.forEach(detach),P.forEach(detach),f=claim_space(w),h=claim_svg_element(w,"svg",{class:!0,viewBox:!0});var J=children$1(h);d=claim_svg_element(J,"defs",{});var ne=children$1(d);m=claim_svg_element(ne,"pattern",{id:!0,x:!0,y:!0,width:!0,height:!0,patternUnits:!0,class:!0});var ie=children$1(m);N=claim_svg_element(ie,"circle",{id:!0,cx:!0,cy:!0,r:!0,style:!0}),children$1(N).forEach(detach),ie.forEach(detach),ne.forEach(detach),V&&V.l(J),B=claim_svg_element(J,"g",{});var oe=children$1(B);for(let Z=0;Z<L.length;Z+=1)L[Z].l(oe);M=empty$1();for(let Z=0;Z<K.length;Z+=1)K[Z].l(oe);b=empty$1();for(let Z=0;Z<U.length;Z+=1)U[Z].l(oe);oe.forEach(detach),J.forEach(detach),this.h()},h(){attr(a,"class",u=null_to_empty(`Node Node-${e[0]}`)+" svelte-76zvyt"),attr(s,"class",_=null_to_empty(`Nodes Nodes-${e[0]}`)+" svelte-76zvyt"),attr(n,"id","graphview-container"),attr(n,"class","svelte-76zvyt"),attr(N,"id","dot"),attr(N,"cx",gridSize/2-dotSize/2),attr(N,"cy",gridSize/2-dotSize/2),attr(N,"r","0.5"),set_style(N,"fill","gray"),attr(m,"id",S=`background-${e[0]}`),attr(m,"x","0"),attr(m,"y","0"),attr(m,"width",gridSize),attr(m,"height",gridSize),attr(m,"patternUnits","userSpaceOnUse"),attr(m,"class","svelte-76zvyt"),attr(h,"class",g=null_to_empty(`Edges Edges-${e[0]}`)+" svelte-76zvyt"),attr(h,"viewBox",y="0 0 "+e[11]+" "+e[12])},m(w,P){k&&k.m(w,P),insert_hydration(w,t,P),insert_hydration(w,n,P),~o&&H[o].m(n,null),append_hydration(n,i),append_hydration(n,s),append_hydration(s,a);for(let G=0;G<C.length;G+=1)C[G]&&C[G].m(a,null);append_hydration(a,l);for(let G=0;G<z.length;G+=1)z[G]&&z[G].m(a,null);append_hydration(a,c);for(let G=0;G<D.length;G+=1)D[G]&&D[G].m(a,null);insert_hydration(w,f,P),insert_hydration(w,h,P),append_hydration(h,d),append_hydration(d,m),append_hydration(m,N),V&&V.m(h,null),append_hydration(h,B);for(let G=0;G<L.length;G+=1)L[G]&&L[G].m(B,null);append_hydration(B,M);for(let G=0;G<K.length;G+=1)K[G]&&K[G].m(B,null);append_hydration(B,b);for(let G=0;G<U.length;G+=1)U[G]&&U[G].m(B,null);I=!0,T||(v=[listen(s,"contextmenu",prevent_default(e[48])),listen(h,"contextmenu",prevent_default(e[47]))],T=!0)},p(w,P){w[10]?k?(k.p(w,P),P[0]&1024&&transition_in(k,1)):(k=create_if_block_8(w),k.c(),transition_in(k,1),k.m(t.parentNode,t)):k&&(group_outros(),transition_out(k,1,1,()=>{k=null}),check_outros());let G=o;if(o=W(w),o===G?~o&&H[o].p(w,P):(r&&(group_outros(),transition_out(H[G],1,1,()=>{H[G]=null}),check_outros()),~o?(r=H[o],r?r.p(w,P):(r=H[o]=X[o](w),r.c()),transition_in(r,1),r.m(n,i)):r=null),P[0]&17){p=w[4];let A;for(A=0;A<p.length;A+=1){const J=get_each_context_5(w,p,A);C[A]?(C[A].p(J,P),transition_in(C[A],1)):(C[A]=create_each_block_5(J),C[A].c(),transition_in(C[A],1),C[A].m(a,l))}for(group_outros(),A=p.length;A<C.length;A+=1)E(A);check_outros()}if(P[0]&65){x=w[6];let A;for(A=0;A<x.length;A+=1){const J=get_each_context_4(w,x,A);z[A]?(z[A].p(J,P),transition_in(z[A],1)):(z[A]=create_each_block_4(J),z[A].c(),transition_in(z[A],1),z[A].m(a,c))}for(group_outros(),A=x.length;A<z.length;A+=1)F(A);check_outros()}if(P[0]&513){R=w[9];let A;for(A=0;A<R.length;A+=1){const J=get_each_context_3(w,R,A);D[A]?(D[A].p(J,P),transition_in(D[A],1)):(D[A]=create_each_block_3(J),D[A].c(),transition_in(D[A],1),D[A].m(a,null))}for(group_outros(),A=R.length;A<D.length;A+=1)q(A);check_outros()}if((!I||P[0]&1&&u!==(u=null_to_empty(`Node Node-${w[0]}`)+" svelte-76zvyt"))&&attr(a,"class",u),(!I||P[0]&1&&_!==(_=null_to_empty(`Nodes Nodes-${w[0]}`)+" svelte-76zvyt"))&&attr(s,"class",_),(!I||P[0]&1&&S!==(S=`background-${w[0]}`))&&attr(m,"id",S),w[13]?V?V.p(w,P):(V=create_if_block_3(w),V.c(),V.m(h,B)):V&&(V.d(1),V=null),P[0]&33){Y=w[5];let A;for(A=0;A<Y.length;A+=1){const J=get_each_context_2(w,Y,A);L[A]?(L[A].p(J,P),transition_in(L[A],1)):(L[A]=create_each_block_2(J),L[A].c(),transition_in(L[A],1),L[A].m(B,M))}for(group_outros(),A=Y.length;A<L.length;A+=1)j(A);check_outros()}if(P[0]&256){Q=w[8];let A;for(A=0;A<Q.length;A+=1){const J=get_each_context_1(w,Q,A);K[A]?(K[A].p(J,P),transition_in(K[A],1)):(K[A]=create_each_block_1(J),K[A].c(),transition_in(K[A],1),K[A].m(B,b))}for(group_outros(),A=Q.length;A<K.length;A+=1)te(A);check_outros()}if(P[0]&128){ee=w[7];let A;for(A=0;A<ee.length;A+=1){const J=get_each_context(w,ee,A);U[A]?(U[A].p(J,P),transition_in(U[A],1)):(U[A]=create_each_block(J),U[A].c(),transition_in(U[A],1),U[A].m(B,null))}for(group_outros(),A=ee.length;A<U.length;A+=1)$(A);check_outros()}(!I||P[0]&1&&g!==(g=null_to_empty(`Edges Edges-${w[0]}`)+" svelte-76zvyt"))&&attr(h,"class",g),(!I||P[0]&6144&&y!==(y="0 0 "+w[11]+" "+w[12]))&&attr(h,"viewBox",y)},i(w){if(!I){transition_in(k),transition_in(r);for(let P=0;P<p.length;P+=1)transition_in(C[P]);for(let P=0;P<x.length;P+=1)transition_in(z[P]);for(let P=0;P<R.length;P+=1)transition_in(D[P]);for(let P=0;P<Y.length;P+=1)transition_in(L[P]);for(let P=0;P<Q.length;P+=1)transition_in(K[P]);for(let P=0;P<ee.length;P+=1)transition_in(U[P]);I=!0}},o(w){transition_out(k),transition_out(r),C=C.filter(Boolean);for(let P=0;P<C.length;P+=1)transition_out(C[P]);z=z.filter(Boolean);for(let P=0;P<z.length;P+=1)transition_out(z[P]);D=D.filter(Boolean);for(let P=0;P<D.length;P+=1)transition_out(D[P]);L=L.filter(Boolean);for(let P=0;P<L.length;P+=1)transition_out(L[P]);K=K.filter(Boolean);for(let P=0;P<K.length;P+=1)transition_out(K[P]);U=U.filter(Boolean);for(let P=0;P<U.length;P+=1)transition_out(U[P]);I=!1},d(w){k&&k.d(w),w&&detach(t),w&&detach(n),~o&&H[o].d(),destroy_each(C,w),destroy_each(z,w),destroy_each(D,w),w&&detach(f),w&&detach(h),V&&V.d(),destroy_each(L,w),destroy_each(K,w),destroy_each(U,w),T=!1,run_all(v)}}}const gridSize=15,dotSize=10;function instance$3(e,t,n){let o,r,i,s,a,l,c,u,_,f,h,d,m,N,S,B,M,b,{canvasId:g}=t,{width:y}=t,{height:I}=t,{initialZoom:T=3}=t,{initialLocation:v}=t,{boundary:k=!1}=t,{minimap:X=!1}=t;const H=findStore(g),{edgesStore:W,nodesStore:p,anchorsStore:C,potentialAnchorsStore:E,temporaryEdgeStore:x,resizeNodesStore:z,nodeSelected:F,backgroundStore:R,movementStore:D,widthStore:q,heightStore:V,d3Scale:Y,edgeEditModal:L,collapsibleStore:j}=H;component_subscribe(e,W,O=>n(45,m=O)),component_subscribe(e,p,O=>n(46,N=O)),component_subscribe(e,C,O=>n(44,d=O)),component_subscribe(e,E,O=>n(42,f=O)),component_subscribe(e,x,O=>n(41,_=O)),component_subscribe(e,z,O=>n(43,h=O)),component_subscribe(e,R,O=>n(13,b=O)),component_subscribe(e,D,O=>n(49,c=O)),component_subscribe(e,q,O=>n(11,B=O)),component_subscribe(e,V,O=>n(12,M=O)),component_subscribe(e,L,O=>n(10,S=O)),component_subscribe(e,j,O=>n(40,u=O));let Q,K,te,ee,U={zoom,zoomTransform:transform,zoomIdentity:identity,select,selectAll,pointer},$=determineD3Instance(k,U,F,y,I,D,R,gridSize,dotSize,g,Y,ie),w={x:0,y:0,k:1};onMount(()=>{U.select(`.Edges-${g}`).call($),U.select(`.Nodes-${g}`).call($),U.select(`#background-${g}`).call($),U.selectAll("#dot").call($),n(3,w=zoomInit(U,g,$,w,v,T,Y))});let P=T,G=v.x,A=v.y;function J(O){k?(U.select(`.Edges-${ne}`).transition().duration(500).call($.translateTo,O.detail.x,O.detail.y),U.select(`.Nodes-${ne}`).transition().duration(500).call($.translateTo,O.detail.x,O.detail.y)):(U.select(`.Edges-${ne}`).transition().duration(500).call($.translateTo,O.detail.x,O.detail.y),U.select(`.Nodes-${ne}`).transition().duration(500).call($.translateTo,O.detail.x,O.detail.y))}const ne=g;function ie(O){if(!c)return;Y.set(O.transform.k),R&&U.select(`#background-${g}`).attr("x",O.transform.x).attr("y",O.transform.y).attr("width",gridSize*O.transform.k).attr("height",gridSize*O.transform.k).selectAll("#dot").attr("x",gridSize*O.transform.k/2-dotSize/2).attr("y",gridSize*O.transform.k/2-dotSize/2).attr("opacity",Math.min(O.transform.k,1)),U.select(`.Edges-${g} g`).attr("transform",O.transform);let re=U.zoomTransform(this);n(3,w=re),H.d3ZoomParameters.set({...re}),U.select(`.Node-${g}`).style("transform","translate("+re.x+"px,"+re.y+"px) scale("+re.k+")").style("transform-origin","0 0")}function oe(O){bubble.call(this,e,O)}function Z(O){bubble.call(this,e,O)}return e.$$set=O=>{"canvasId"in O&&n(0,g=O.canvasId),"width"in O&&n(29,y=O.width),"height"in O&&n(30,I=O.height),"initialZoom"in O&&n(31,T=O.initialZoom),"initialLocation"in O&&n(32,v=O.initialLocation),"boundary"in O&&n(1,k=O.boundary),"minimap"in O&&n(2,X=O.minimap)},e.$$.update=()=>{if(e.$$.dirty[1]&32768&&n(39,o=Object.values(N)),e.$$.dirty[1]&16384&&n(36,r=Object.values(m)),e.$$.dirty[1]&8192&&n(37,i=Object.values(d)),e.$$.dirty[1]&4096&&n(38,s=Object.values(h)),e.$$.dirty[1]&2048&&n(9,a=Object.values(f)),e.$$.dirty[1]&1024&&n(8,l=_),e.$$.dirty[1]&992){const O=filterByCollapsible(H,o,s,i,r);n(4,Q=O.filteredNodes),n(5,K=O.filteredEdges),n(6,te=O.filteredResizeNodes),n(7,ee=O.filteredAnchors)}e.$$.dirty[0]&9|e.$$.dirty[1]&31&&(T!==P||G!==v.x||A!==v.y)&&(n(33,P=T),n(34,G=v.x),n(35,A=v.y),n(3,w=zoomInit(U,g,$,w,v,T,Y)))},[g,k,X,w,Q,K,te,ee,l,a,S,B,M,b,H,W,p,C,E,x,z,R,D,q,V,L,j,J,ne,y,I,T,v,P,G,A,r,i,s,o,u,_,f,h,d,m,N,oe,Z]}class GraphView extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$3,create_fragment$3,safe_not_equal,{canvasId:0,width:29,height:30,initialZoom:31,initialLocation:32,boundary:1,minimap:2},null,[-1,-1,-1])}}function sanitizeCanvasOptions(e){enforceCollapsibleCompatibility(e)}function enforceCollapsibleCompatibility(e){get_store_value(e.collapsibleOption)&&e.nodeCreate.set(!1)}function sanitizeUserNodesAndEdges(e,t){return convertIdToString(e),convertEdgeIdsToString(t),convertAnchorPositionsToCallbacks(e,t),setDefaultEdgeType(t),{userNodes:e,userEdges:t}}function setDefaultEdgeType(e){for(let t of e)["smoothstep","step","bezier","straight"].includes(t.type)||(t.type="bezier")}function convertAnchorPositionsToCallbacks(e,t){const n={};for(let o of e)n[o.id]=o;for(let o of t){const r=n[o.source],i=n[o.target],s=r.sourcePosition,a=i.targetPosition,l={left:leftCb,right:rightCb,top:topCb,bottom:bottomCb};s&&(o.sourceAnchorCb=l[s]),a&&(o.targetAnchorCb=l[a])}}function convertIdToString(e){e=e.map(t=>(t.id=t.id.toString(),t.childNodes=t.childNodes===void 0?[]:t.childNodes.map(n=>n.toString()),t))}function convertEdgeIdsToString(e){e=e.map(t=>(t.source=t.source.toString(),t.target=t.target.toString(),t))}const ImportExport_svelte_svelte_type_style_lang="";function create_fragment$2(e){let t,n,o,r,i,s,a,l,c,u,_,f,h,d,m,N,S,B;return{c(){t=element("div"),n=element("a"),o=svg_element("svg"),r=svg_element("g"),i=svg_element("g"),s=svg_element("path"),a=svg_element("g"),l=svg_element("polygon"),c=svg_element("path"),_=space(),f=element("input"),d=space(),m=element("button"),N=text("Upload"),this.h()},l(M){t=claim_element(M,"DIV",{id:!0,class:!0});var b=children$1(t);n=claim_element(b,"A",{href:!0,id:!0,download:!0,class:!0});var g=children$1(n);o=claim_svg_element(g,"svg",{id:!0,viewBox:!0,xmlns:!0,fill:!0,class:!0});var y=children$1(o);r=claim_svg_element(y,"g",{id:!0,"stroke-width":!0}),children$1(r).forEach(detach),i=claim_svg_element(y,"g",{id:!0});var I=children$1(i);s=claim_svg_element(I,"path",{d:!0,fill:!0}),children$1(s).forEach(detach),a=claim_svg_element(I,"g",{id:!0});var T=children$1(a);l=claim_svg_element(T,"polygon",{points:!0}),children$1(l).forEach(detach),c=claim_svg_element(T,"path",{d:!0}),children$1(c).forEach(detach),T.forEach(detach),I.forEach(detach),y.forEach(detach),g.forEach(detach),_=claim_space(b),f=claim_element(b,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0}),d=claim_space(b),m=claim_element(b,"BUTTON",{id:!0,class:!0});var v=children$1(m);N=claim_text(v,"Upload"),v.forEach(detach),b.forEach(detach),this.h()},h(){attr(r,"id","SVGRepo_bgCarrier"),attr(r,"stroke-width","0"),attr(s,"d","M0 0h48v48H0z"),attr(s,"fill","none"),attr(l,"points","22,4 22,20 14,20 24,30 34,20 26,20 26,4 "),attr(c,"d","M8,44h32c2.206,0,4-1.794,4-4V30h-4v10H8V30H4v10C4,42.206,5.794,44,8,44z"),attr(a,"id","Shopicon"),attr(i,"id","SVGRepo_iconCarrier"),attr(o,"id","dwnldimg"),attr(o,"viewBox","0 0 48 48"),attr(o,"xmlns","http://www.w3.org/2000/svg"),attr(o,"fill","#000000"),attr(o,"class","svelte-eba1ux"),attr(n,"href",e[1]),attr(n,"id",u="downloadState-"+e[0]),attr(n,"download","svelvet-state.json"),attr(n,"class","svelte-eba1ux"),attr(f,"type","text"),attr(f,"id",h=`store-input-${e[0]}`),attr(f,"placeholder","Paste JSON here"),attr(f,"class","svelte-eba1ux"),attr(m,"id","store-input-btn"),attr(m,"class","svelte-eba1ux"),attr(t,"id","export-import"),attr(t,"class","svelte-eba1ux")},m(M,b){insert_hydration(M,t,b),append_hydration(t,n),append_hydration(n,o),append_hydration(o,r),append_hydration(o,i),append_hydration(i,s),append_hydration(i,a),append_hydration(a,l),append_hydration(a,c),append_hydration(t,_),append_hydration(t,f),append_hydration(t,d),append_hydration(t,m),append_hydration(m,N),S||(B=[listen(n,"click",e[7]),listen(m,"click",e[6])],S=!0)},p(M,[b]){b&2&&attr(n,"href",M[1]),b&1&&u!==(u="downloadState-"+M[0])&&attr(n,"id",u),b&1&&h!==(h=`store-input-${M[0]}`)&&attr(f,"id",h)},i:noop$1,o:noop$1,d(M){M&&detach(t),S=!1,run_all(B)}}}function instance$2($$self,$$props,$$invalidate){let $edgesStore,$nodesStore,{canvasId}=$$props;const store=findStore(canvasId),{nodesStore,edgesStore}=store;component_subscribe($$self,nodesStore,e=>$$invalidate(9,$nodesStore=e)),component_subscribe($$self,edgesStore,e=>$$invalidate(8,$edgesStore=e));const rawNodeData=[],rawEdgeData=[];let fileHref="";const getData=()=>{for(const e in $nodesStore)rawNodeData.push($nodesStore[e].setExportableData());for(const e in $edgesStore)rawEdgeData.push($edgesStore[e].setExportableData())},exportNodesAndEdges=()=>{$$invalidate(1,fileHref=(n=>{const o=new Blob([JSON.stringify(n)],{type:"application/json"});return window.URL.createObjectURL(o)})({nodes:rawNodeData,edges:rawEdgeData}))},uploadStore=()=>{const storeInput=document.getElementById(`store-input-${canvasId}`),reviver=(key,value)=>key==="custom"?eval(value):value,text=storeInput.value;if(text==="")return;const newStore=JSON.parse(text,reviver);populateSvelvetStoreFromUserInput(canvasId,newStore.nodes,newStore.edges),storeInput.value=""},click_handler=()=>{getData(),exportNodesAndEdges()};return $$self.$$set=e=>{"canvasId"in e&&$$invalidate(0,canvasId=e.canvasId)},[canvasId,fileHref,nodesStore,edgesStore,getData,exportNodesAndEdges,uploadStore,click_handler]}class ImportExport extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$2,create_fragment$2,safe_not_equal,{canvasId:0})}}const Svelvet_svelte_svelte_type_style_lang="";function create_if_block(e){let t,n;return t=new ImportExport({props:{canvasId:e[4]}}),{c(){create_component(t.$$.fragment)},l(o){claim_component(t.$$.fragment,o)},m(o,r){mount_component(t,o,r),n=!0},p(o,r){const i={};r&16&&(i.canvasId=o[4]),t.$set(i)},i(o){n||(transition_in(t.$$.fragment,o),n=!0)},o(o){transition_out(t.$$.fragment,o),n=!1},d(o){destroy_component(t,o)}}}function create_fragment$1(e){let t,n,o,r,i;n=new GraphView({props:{canvasId:e[4],width:e[2],height:e[3],initialLocation:e[6],initialZoom:e[5],boundary:e[7],minimap:e[1]}});let s=e[8]&&create_if_block(e);return{c(){t=element("div"),create_component(n.$$.fragment),o=space(),s&&s.c(),this.h()},l(a){t=claim_element(a,"DIV",{class:!0,style:!0});var l=children$1(t);claim_component(n.$$.fragment,l),o=claim_space(l),s&&s.l(l),l.forEach(detach),this.h()},h(){attr(t,"class","Svelvet svelte-tw9ly1"),attr(t,"style",r=`width: ${e[2]}px; height: ${e[3]}px; background-color: ${e[0]};`)},m(a,l){insert_hydration(a,t,l),mount_component(n,t,null),append_hydration(t,o),s&&s.m(t,null),i=!0},p(a,[l]){const c={};l&16&&(c.canvasId=a[4]),l&4&&(c.width=a[2]),l&8&&(c.height=a[3]),l&64&&(c.initialLocation=a[6]),l&32&&(c.initialZoom=a[5]),l&128&&(c.boundary=a[7]),l&2&&(c.minimap=a[1]),n.$set(c),a[8]?s?(s.p(a,l),l&256&&transition_in(s,1)):(s=create_if_block(a),s.c(),transition_in(s,1),s.m(t,null)):s&&(group_outros(),transition_out(s,1,1,()=>{s=null}),check_outros()),(!i||l&13&&r!==(r=`width: ${a[2]}px; height: ${a[3]}px; background-color: ${a[0]};`))&&attr(t,"style",r)},i(a){i||(transition_in(n.$$.fragment,a),transition_in(s),i=!0)},o(a){transition_out(n.$$.fragment,a),transition_out(s),i=!1},d(a){a&&detach(t),destroy_component(n),s&&s.d()}}}function instance$1(e,t,n){const o=()=>(Math.random()+1).toString(36).substring(7);let{nodes:r}=t,{edges:i}=t,{bgColor:s="#ffffff"}=t,{minimap:a=!1}=t,{width:l=600}=t,{height:c=600}=t,{background:u=!0}=t,{movement:_=!0}=t,{canvasId:f=o()}=t,{snap:h=!1}=t,{snapTo:d=30}=t,{nodeCreate:m=!1}=t,{initialZoom:N=3}=t,{initialLocation:S={x:0,y:0}}=t,{boundary:B=!1}=t,{collapsible:M=!1}=t,{shareable:b=!1}=t,{locked:g=!1}=t,{editable:y=!1}=t,{resizable:I=!0}=t,{highlightEdges:T=!0}=t;const v=createStoreEmpty(f);return onMount(()=>{let k=sanitizeUserNodesAndEdges(r,i);const X=k.userNodes,H=k.userEdges;v.widthStore.set(l),v.heightStore.set(c),v.backgroundStore.set(u),v.movementStore.set(_);const W={snap:h,snapTo:d};v.options.set(W),v.nodeCreate.set(m),v.boundary.set(B),v.collapsibleOption.set(M),v.lockedOption.set(g),v.editableOption.set(y),v.resizableOption.set(I),v.highlightEdgesOption.set(T),sanitizeCanvasOptions(v),populateSvelvetStoreFromUserInput(f,X,H)}),afterUpdate(()=>{let k=sanitizeUserNodesAndEdges(r,i);const X=k.userNodes,H=k.userEdges;v.widthStore.set(l),v.heightStore.set(c),v.backgroundStore.set(u),v.movementStore.set(_);const W={snap:h,snapTo:d};v.options.set(W),v.nodeCreate.set(m),v.boundary.set(B),v.collapsibleOption.set(M),v.lockedOption.set(g),v.editableOption.set(y),v.resizableOption.set(I),v.highlightEdgesOption.set(T),sanitizeCanvasOptions(v),populateSvelvetStoreFromUserInput(f,X,H)}),e.$$set=k=>{"nodes"in k&&n(9,r=k.nodes),"edges"in k&&n(10,i=k.edges),"bgColor"in k&&n(0,s=k.bgColor),"minimap"in k&&n(1,a=k.minimap),"width"in k&&n(2,l=k.width),"height"in k&&n(3,c=k.height),"background"in k&&n(11,u=k.background),"movement"in k&&n(12,_=k.movement),"canvasId"in k&&n(4,f=k.canvasId),"snap"in k&&n(13,h=k.snap),"snapTo"in k&&n(14,d=k.snapTo),"nodeCreate"in k&&n(15,m=k.nodeCreate),"initialZoom"in k&&n(5,N=k.initialZoom),"initialLocation"in k&&n(6,S=k.initialLocation),"boundary"in k&&n(7,B=k.boundary),"collapsible"in k&&n(16,M=k.collapsible),"shareable"in k&&n(8,b=k.shareable),"locked"in k&&n(17,g=k.locked),"editable"in k&&n(18,y=k.editable),"resizable"in k&&n(19,I=k.resizable),"highlightEdges"in k&&n(20,T=k.highlightEdges)},[s,a,l,c,f,N,S,B,b,r,i,u,_,h,d,m,M,g,y,I,T]}class Svelvet extends SvelteComponent{constructor(t){super(),init$1(this,t,instance$1,create_fragment$1,safe_not_equal,{nodes:9,edges:10,bgColor:0,minimap:1,width:2,height:3,background:11,movement:12,canvasId:4,snap:13,snapTo:14,nodeCreate:15,initialZoom:5,initialLocation:6,boundary:7,collapsible:16,shareable:8,locked:17,editable:18,resizable:19,highlightEdges:20})}}const _layout_svelte_svelte_type_style_lang="";function create_fragment(e){let t,n,o;t=new Svelvet({props:{nodes:e[0],edges:e[1],width:800,height:800,background:!1,bgColor:"#EAE7DC",locked:!0,collapsible:!0,movement:!1}});const r=e[3].default,i=create_slot(r,e,e[2],null);return{c(){create_component(t.$$.fragment),n=space(),i&&i.c()},l(s){claim_component(t.$$.fragment,s),n=claim_space(s),i&&i.l(s)},m(s,a){mount_component(t,s,a),insert_hydration(s,n,a),i&&i.m(s,a),o=!0},p(s,[a]){i&&i.p&&(!o||a&4)&&update_slot_base(i,r,s,s[2],o?get_slot_changes(r,s[2],a,null):get_all_dirty_from_scope(s[2]),null)},i(s){o||(transition_in(t.$$.fragment,s),transition_in(i,s),o=!0)},o(s){transition_out(t.$$.fragment,s),transition_out(i,s),o=!1},d(s){destroy_component(t,s),s&&detach(n),i&&i.d(s)}}}function instance(e,t,n){let{$$slots:o={},$$scope:r}=t;const i=[{id:0,position:{x:25,y:50},data:{label:"Elinkeino- verolaki"},width:100,height:60,bgColor:"white"},{id:1,position:{x:175,y:50},data:{label:"Säännös 1"},width:100,height:40,bgColor:"white"},{id:2,position:{x:175,y:150},data:{label:"Säännös 2"},width:100,height:40,bgColor:"white"},{id:11,position:{x:325,y:50},data:{label:"Säännös 1.1"},width:100,height:40,bgColor:"white"},{id:21,position:{x:325,y:150},data:{label:"Säännös 2.1"},width:100,height:40,bgColor:"white"},{id:22,position:{x:325,y:200},data:{label:"Säännös 2.2"},width:100,height:40,bgColor:"white"},{id:23,position:{x:325,y:250},data:{label:"Säännös 2.3"},width:100,height:40,bgColor:"white"},{id:221,position:{x:475,y:215},data:{label:"Säännös 2.2.1: Säännös kertoo seuraavaa..."},width:150,height:50,bgColor:"white"},{id:211,position:{x:475,y:150},data:{label:"Säännös 2.1.1: Säännös kertoo seuraavaa..."},width:150,height:50,bgColor:"white"}],s=[{id:"e1-2",source:0,target:1},{id:"e1-3",source:0,target:2},{id:"e2-3",source:1,target:11},{id:"e3-4",source:2,target:21},{id:"e4-5",source:2,target:22},{id:"e4-6",source:2,target:23},{id:"e6-7",source:22,target:221},{id:"e6-8",source:21,target:211}];return e.$$set=a=>{"$$scope"in a&&n(2,r=a.$$scope)},[i,s,r,o]}class Layout extends SvelteComponent{constructor(t){super(),init$1(this,t,instance,create_fragment,safe_not_equal,{})}}export{Layout as default};
